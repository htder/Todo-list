(()=>{"use strict";const e=function(e,t,n,o,r,c){const s={};return s.title=e,s.description=t,s.dueDate=n,s.completed=o,s.priority=r,s.project=c,s.due=function(){return`${e} due: ${n}`},s},t=function(e){const t={};return t.title=e,t},n={tasks:[e("Hello World","one two three","2022-01-21",!0,"high","All"),e("World Hello","one two three","2022-02-01",!1,"low","Project 2"),e("One One One","One Hello","2022-09-17",!0,"middle","Project 2"),e("Two Two Two","Two Hello","2022-01-09",!1,"high","Project 3"),e("Three Three Three","Three Hello","2022-12-25",!1,"high","All")],projects:[t("All"),t("Project 2"),t("Project 3")]};document.querySelector(".sidebar").addEventListener("click",(e=>{Array.from(document.querySelectorAll(".menu-button")).forEach((e=>e.classList.remove("active"))),null!==e.target.closest("a")&&e.target.closest("a").classList.add("active")})),function(){const e=document.querySelector(".project-modal"),c=document.querySelector(".new-project-button"),s=document.querySelector(".project-modal-close"),i=document.querySelector(".project-submit"),l=document.getElementById("new-project-form");c.addEventListener("click",(()=>{d()})),s.addEventListener("click",(()=>{a()})),i.addEventListener("click",(e=>{e.preventDefault();const c=l.title;if(o.checkTitle(c)){const e=t(c.value);n.projects.push(e),r.addProjectToView(e),o.clearForm(l),a()}}));const d=function(){e.classList.remove("hide"),e.classList.add("show")},a=function(){e.classList.remove("show"),e.classList.add("hide")}}();const o={checkTitle:e=>{let t=!1;return""===e.value.trim()?e.classList.add("error"):(e.classList.remove("error"),t=!0),t},clearForm:e=>{e.title.value=""}},r=function(){const e=document.querySelector(".project-menu"),t=document.querySelector(".form-project-selector");return{addProjectToView:t=>{e.appendChild((e=>{const t=`\n      <a href="#" class="nav-link menu-button link-dark rounded">\n        <img\n          class="bi me-2"\n          width="16"\n          height="16"\n          src="../icons/arrow-right-short.svg"\n        /><span class="d-none d-sm-inline">${e.title}</span></a\n      >`,n=document.createElement("li");return n.classList="nav-item m-1",n.innerHTML=t,n})(t))},addProjectToTodoSelectorForm:()=>{let e="";n.projects.forEach((t=>{e+=`<option>${t.title}</option>`})),t.innerHTML=e}}}(),c=(function(){const t=document.querySelector(".task-modal"),o=document.querySelector(".todo-new-task"),i=document.querySelector(".todo-modal-close"),l=document.getElementById("new-todo-form"),d=document.querySelector(".todo-submit");console.log(o),o.addEventListener("click",(()=>{r.addProjectToTodoSelectorForm(),a()})),i.addEventListener("click",(()=>{u()})),d.addEventListener("click",(t=>{t.preventDefault();const o=document.querySelector(".form-project-selector"),r=l.title,i=l.description,d=l.dueDate,a=o.options[o.selectedIndex].value,m=l.optradio.value;let p=c.checkTitle(r),h=c.checkDescription(i),g=c.checkDate(d);if(p&&h&&g){const t=e(r.value,i.value,d.value,!1,m,a);n.tasks.push(t),s.addTodoToView(t),c.clearForm(l),u()}}));const a=()=>{t.classList.remove("hide"),t.classList.add("show")},u=()=>{t.classList.remove("show"),t.classList.add("hide")}}(),function(){const e=e=>""===e,t=(e,t)=>{document.querySelector(".dateError").textContent=t};return{checkTitle:t=>{let n=!1;const o=t.value.trim();return e(o)?("Title cannot be empty.",document.querySelector(".titleError").textContent="Title cannot be empty."):(document.querySelector(".titleError").textContent="",n=!0),n},checkDescription:t=>{let n=!1;const o=t.value.trim();return e(o)?("Description cannot be empty.",document.querySelector(".descError").textContent="Description cannot be empty."):(document.querySelector(".descError").textContent="",n=!0),n},checkDate:n=>{let o=!1;const r=n.value.trim();return e(r)&&t(0,"Due date cannot be empty"),(e=>{const t=new Date(`${e}`),[n,o,r]=e.split("-"),c=new Date,s=c.getDate(),i=c.getMonth()+1;return!(+n===c.getFullYear()&&+o===i&&+r===s||t>c)})(r)?t(0,"Due date must be in the future."):(document.querySelector(".dateError").textContent="",o=!0),o},clearForm:e=>{e.title.value="",e.description.value="",e.dueDate.value=""}}}()),s=function(){const e=document.querySelector(".todo-container");return{addTodoToView:t=>{e.appendChild((e=>{const t=`\n    <div\n    class="col-md-1 py-1 d-flex justify-content-md-end justify-content-center"\n  >\n    <input type="checkbox" class="task-checkbox" ${e.completed?"checked":""}/>\n  </div>\n  <div\n    class="col-md-6 d-flex align-items-center justify-content-md-start justify-content-center"\n  >\n    ${e.completed?`<del>${e.title}</del>`:`${e.title}`}\n  </div>\n    <div\n        class="col-md-1 d-flex align-items-center justify-md-start justify-content-center task-arrow"\n         >\n        <img\n         class="task-arrow-image-down"\n         width="16"\n         height="16"\n         src="../icons/caret-down.svg"\n         />\n    </div>\n  <div\n    class="col-md-2 d-flex align-items-center justify-content-md-start justify-content-center"\n  >\n    ${e.dueDate}\n  </div>\n  <div\n    class="col-md-1 d-flex align-items-center justify-md-start justify-content-center"\n  >\n      <img\n        class="task-edit"\n        width="16"\n        height="16"\n        src="../icons/pencil-square.svg"\n      />\n\n  </div>\n  <div\n    class="col-md-1 d-flex align-items-center justify-md-start justify-content-center"\n  >\n      <img\n        class="task-delete"\n        width="16"\n        height="16"\n        src="../icons/trash.svg"\n      />\n  </div>`,n=document.createElement("div");return n.classList="row m-4 p-2 bg-white rounded-3 border-bottom  "+("high"===e.priority?"red-border":"middle"===e.priority?"orange-border":"green-border"),n.innerHTML=t,n})(t))},removeAllTasks:()=>{for(;e.firstChild;)e.removeChild(e.lastChild)}}}(),i=(function(){document.querySelector(".todo-main-container").addEventListener("click",(r=>{const c=r.target.classList.contains("task-checkbox"),l=r.target.classList.contains("task-arrow-image-down")||r.target.classList.contains("task-arrow-image-up"),d=r.target.classList.contains("task-edit"),a=r.target.classList.contains("task-delete");if(c){const e=Array.from(r.target.parentNode.parentNode.childNodes),t=e[3].textContent.trim(),o=e[7].textContent.trim(),c=n.tasks.filter((e=>e.title===t&&e.dueDate===o));c[0].completed=!c[0].completed,c[0].completed?e[3].innerHTML=`<del>${e[3].innerHTML}</del>`:e[3].innerHTML=e[3].innerHTML.replace(/(<([^>]+)>)/gi,"")}if(l){let c,s,i;if(r.target.classList.contains("task-arrow-image-down")){const t=Array.from(r.target.parentNode.parentNode.childNodes);let l=r.target.parentNode;i=r.target.parentNode.parentNode,console.log(t),console.log(i),c=t[3].textContent.trim(),s=t[7].textContent.trim(),l.innerHTML=e(),console.log(c,s);const d=n.tasks.filter((e=>e.title===c&&e.dueDate===s));console.log(d);const a=o(d);i.insertAdjacentElement("afterend",a)}if(r.target.classList.contains("task-arrow-image-up")){const e=Array.from(r.target.parentNode.parentNode.childNodes);let n=r.target.parentNode;i=r.target.parentNode.parentNode,c=e[3].textContent.trim(),s=e[7].textContent.trim(),n.innerHTML=t(),i.nextElementSibling.remove()}}if(d){const e=Array.from(r.target.parentNode.parentNode.childNodes);let t=e[3].textContent.trim(),o=e[7].textContent.trim();const c=n.tasks.filter((e=>e.title===t&&e.dueDate===o));console.log(c),i.fillForm(c),i.open()}if(a){const e=Array.from(r.target.parentNode.parentNode.childNodes);let t=e[3].textContent.trim(),o=e[7].textContent.trim();const c=n.tasks.filter((e=>e.title===t&&e.dueDate===o));let i;n.tasks.filter(((e,t)=>{c[0].title===e.title&&c[0].description===e.description&&c[0].dueDate===e.dueDate&&(i=t)})),n.tasks.splice(i,1),s.removeAllTasks(),n.tasks.forEach((e=>s.addTodoToView(e)))}}));const e=()=>'\n    <img\n        class="task-arrow-image-up"\n        width="16"\n        height="16"\n        src="../icons/caret-up.svg"\n    />',t=()=>'\n    <img\n        class="task-arrow-image-down"\n        width="16"\n        height="16"\n        src="../icons/caret-down.svg"\n    />',o=e=>{console.log(e);const t=`\n    <div class="container-fluid py-1">\n      <h6 class="fw-bold">Description</h6>\n      <p class="">\n      ${e[0].description}\n      </p>\n  </div>`,n=document.createElement("div");return n.classList="modal-body mx-5 my-3 bg-light rounded-3 border border-secondary p-3 rounded-3 description-div",n.innerHTML=t,n}}(),function(){const t=document.querySelector(".edit-modal"),o=document.getElementById("edit-modal-form"),r=document.querySelector(".edit-submit"),i=document.querySelector(".edit-cancel");let l;const d=()=>{t.classList.remove("show"),t.classList.add("hide")};return i.addEventListener("click",(()=>{c.clearForm(o),d()})),r.addEventListener("click",(t=>{console.log(l),t.preventDefault();const r=o.title,i=o.description,a=o.dueDate;let u=c.checkTitle(r),m=c.checkDescription(i),p=c.checkDate(a);if(u&&m&&p){const t=e(r.value,i.value,a.value,l.completed,l.priority,l.project);let u;n.tasks.filter(((e,t)=>{l[0].title===e.title&&l[0].description===e.description&&l[0].dueDate===e.dueDate&&(u=t)})),n.tasks.splice(u,1,t),c.clearForm(o),s.removeAllTasks(),n.tasks.forEach((e=>s.addTodoToView(e))),d()}})),{open:()=>{t.classList.remove("hide"),t.classList.add("show")},close:d,fillForm:e=>{l=e,console.log(l),o.title.value=e[0].title,o.description.value=e[0].description,o.dueDate.value=e[0].dueDate}}}());n.projects.forEach((e=>r.addProjectToView(e))),n.tasks.forEach((e=>s.addTodoToView(e)))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QzBILEVBQVksR0FBR3pILFVBQVlvSCxFQUFFcEgsVUFFN0JtSCxFQUFRRSxNQUlaOUcsRUFBTUMsTUFBTThHLE9BQU9ILEVBQU8sRUFBR2pELEdBRzdCYixFQUFvQmIsVUFBVVosR0FFOUJ1QyxFQUFTdUIsaUJBQ1RuRixFQUFNQyxNQUFNUyxTQUFTYixHQUFTK0QsRUFBU0MsY0FBY2hFLEtBR3JEcUQsUUFJRyxDQUFFRCxLQXRFSSxLQUNYaEMsRUFBTUwsVUFBVUMsT0FBTyxRQUN2QkksRUFBTUwsVUFBVUksSUFBSSxTQW9FUGtDLE1BQUFBLEVBQU95RCxTQTVESjlHLElBQ2hCcUgsRUFBY3JILEVBQ2RrRCxRQUFRQyxJQUFJa0UsR0FDWjdGLEVBQVksTUFBRVEsTUFBUWhDLEVBQUssR0FBR04sTUFDOUI4QixFQUFrQixZQUFFUSxNQUFRaEMsRUFBSyxHQUFHTCxZQUNwQzZCLEVBQWMsUUFBRVEsTUFBUWhDLEVBQUssR0FBR0osVUF0QmQsSUFnRnRCTyxFQUFNRSxTQUFTUSxTQUFTZCxHQUFZbUMsRUFBZ0JDLGlCQUFpQnBDLEtBQ3JFSSxFQUFNQyxNQUFNUyxTQUFTYixHQUFTK0QsRUFBU0MsY0FBY2hFLE0iLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9zcmMvdGFzay5qcyIsIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9zcmMvcHJvamVjdC5qcyIsIndlYnBhY2s6Ly90b2RvLWxpc3QvLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgVG9kb1Rhc2sgPSBmdW5jdGlvbiAoXG4gIHRpdGxlLFxuICBkZXNjcmlwdGlvbixcbiAgZHVlRGF0ZSxcbiAgY29tcGxldGVkLFxuICBwcmlvcml0eSxcbiAgcHJvamVjdFxuKSB7XG4gIGNvbnN0IHRhc2sgPSB7fTtcblxuICB0YXNrLnRpdGxlID0gdGl0bGU7XG4gIHRhc2suZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjtcbiAgdGFzay5kdWVEYXRlID0gZHVlRGF0ZTtcbiAgdGFzay5jb21wbGV0ZWQgPSBjb21wbGV0ZWQ7XG4gIHRhc2sucHJpb3JpdHkgPSBwcmlvcml0eTtcbiAgdGFzay5wcm9qZWN0ID0gcHJvamVjdDtcblxuICB0YXNrLmR1ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gYCR7dGl0bGV9IGR1ZTogJHtkdWVEYXRlfWA7XG4gIH07XG5cbiAgcmV0dXJuIHRhc2s7XG59O1xuXG5leHBvcnQgeyBUb2RvVGFzayB9O1xuIiwiY29uc3QgUHJvamVjdCA9IGZ1bmN0aW9uICh0aXRsZSkge1xuICBjb25zdCBwcm9qZWN0ID0ge307XG5cbiAgcHJvamVjdC50aXRsZSA9IHRpdGxlO1xuXG4gIHJldHVybiBwcm9qZWN0O1xufTtcblxuZXhwb3J0IHsgUHJvamVjdCB9O1xuIiwiLy8gVG9kbyBMaXN0IEl0ZW0gbmVlZHMgYTpcbi8vIC0gcHJvamVjdCBiZWxvbmdzIHRvXG4vLyAtIHRpdGxlXG4vLyAtIGRlc2NyaXB0aW9uXG4vLyAtIGR1ZSBkYXRlXG4vLyAtIGNvbXBsZXRlZCBjaGVjayBib3hcbi8vIC0gcmVkLCBvcmFuZ2Ugb3IgZ3JlZW4gZm9yIGRpZmZlcmVudCBwcmlvcml0aWVzXG5cbi8vIEZhY3RvcnkgZnVuY3Rpb24gZm9yIGEgdG9kbyBsaXN0IGl0ZW1cblxuLy8gUHJvamVjdCBuZWVkcyBhOlxuLy8gLSBsaXN0IG9mIHplcm8gb3IgbW9yZSB0b2RvIGl0ZW1zXG5cbi8vIEZhY3RvcnkgZnVuY3Rpb24gZm9yIGEgcHJvamVjdFxuXG4vLyBWaWV3czpcbi8vIC0gc2lkZWJhciB2aWV3XG4vLyAtIHByb2plY3Qgdmlld1xuLy8gLSBhbGwgdGFzayB2aWV3XG4vLyAtIHRvZGF5J3MgdGFza3Mgdmlld1xuLy8gLSB0aGlzIHdlZWsncyB0YXNrcyB2aWV3XG4vLyAtIHByb2plY3QncyB0YXNrcyB2aWV3XG5cbi8vIE1vZGFsczpcbi8vIC0gZWRpdCB0b2RvIGl0ZW1cbi8vIC0gY3JlYXRlIG5ldyB0b2RvIGl0ZW1cbi8vIC0gY3JlYXRlIG5ldyBwcm9qZWN0XG5cbi8vIFRvZG8gQ29udHJvbGxlcjpcbi8vIC0gZGVsZXRlIHRvZG9cbi8vIC0gc2hvdyBlZGl0IG1vZGFsXG4vLyAtIGV4cGFuZCBkZXRhaWxzXG5cbi8vIFByb2plY3QgQ29udHJvbGxlcjpcbi8vIC0gZGVsZXRlIHByb2plY3RcblxuLy9cbi8vXG4vL1xuLy9cbi8vIC8vIGNoYW5naW5nIGFjdGl2ZSBidXR0b24gb24gdGhlIG1lbnVcbi8vIC8vIGFkZGluZyBwcm9qZWN0IG1vZGFsIHdoZW4gbmV3IHByb2plY3QgaXMgcHJlc3NlZFxuLy8gLy8gYWRkaW5nIG5ldyB0b2RvIHRhc2sgbW9kYWwgd2hlbiBhZGQgYSBuZXcgcHJvamVjdCBpcyBwcmVzc2VkXG4vLyAvLyBkZWNpZGUgb24gaG93IGRhdGEgZm9yIHRhc2tzIGlzIHN0b3JlZFxuLy8gLy8gc3VibWl0dGluZyBwcm9qZWN0IG1vZGFsIGFkZHMgYSBuZXcgcHJvamVjdCAtIGhvdyBpcyBpdCBzdG9yZWQ/XG4vLyAvLyBzdWJtaXR0aW5nIHRvZG8gdGFzayBtb2RhbCBhZGRzIGEgbmV3IHRhc2sgLSBob3cgaXMgaXQgc3RvcmVkP1xuLy8gLy8gYWRkIGV2ZW50IGxpc3RlbmVycyB0byB0YXNrc1xuLy8gLy8gc2hvdyBkZXRhaWxzIHNsaWRlciB3aGVuIGRvd24gYXJyb3cgaXMgcHJlc3NlZFxuLy8gLy8gY2hhbmdlIGFycm93IGljb24gd2hlbiBkZXRhaWxzIGFyZSBzaG93aW5nIGFuZCB3aGVuIHRoZXkgYXJlIG5vdFxuLy8gLy8gY29tcGxldGluZyB0YXNrIC0gaG93IGRvZXMgaXQgaW50ZXJhY3Qgd2l0aCBkYXRhXG4vL1xuLy8gLy8gc3RyaWtlIHRocm91Z2ggdGhlIHRpdGxlIHdoZW4gdGhlIHRhc2sgaXMgY29tcGxldGVcbi8vIC8vIHNob3cgZWRpdCBzbGlkZXIgd2hlbiBlZGl0IGlzIHByZXNzZWRcbi8vIC8vIHNob3dpbmcgdGFzayBwcmlvcml0eSBjb2xvdXIgYXMgdGhlIGxlZnQgYm9yZGVyIGNvbG91ciBvZiB0aGUgdGFza1xuLy8gZGVsZXRlaW5nIHRhc2sgLSBob3cgZG9lcyBpdCBpbnRlcmFjdCB3aXRoIGRhdGFcbi8vIHBvcHVsYXRlIHRoZSB0b2RheSBhbmQgdGhpcyB3ZWVrIHZpZXdzIHdpdGggdGhlIGNvcnJlY3QgdGFza3Ncbi8vIHBvcHVsYXRlIGVhY2ggcHJvamVjdCB3aXRoIHRoZSBjb3JyZWN0IHRhc2tzXG4vL1xuLy9cbi8vXG5cbmltcG9ydCB7IFRvZG9UYXNrIH0gZnJvbSBcIi4vdGFzay5qc1wiO1xuaW1wb3J0IHsgUHJvamVjdCB9IGZyb20gXCIuL3Byb2plY3QuanNcIjtcblxuY29uc3QgbW9kZWwgPSB7XG4gIHRhc2tzOiBbXG4gICAgVG9kb1Rhc2soXCJIZWxsbyBXb3JsZFwiLCBcIm9uZSB0d28gdGhyZWVcIiwgXCIyMDIyLTAxLTIxXCIsIHRydWUsIFwiaGlnaFwiLCBcIkFsbFwiKSxcbiAgICBUb2RvVGFzayhcbiAgICAgIFwiV29ybGQgSGVsbG9cIixcbiAgICAgIFwib25lIHR3byB0aHJlZVwiLFxuICAgICAgXCIyMDIyLTAyLTAxXCIsXG4gICAgICBmYWxzZSxcbiAgICAgIFwibG93XCIsXG4gICAgICBcIlByb2plY3QgMlwiXG4gICAgKSxcbiAgICBUb2RvVGFzayhcbiAgICAgIFwiT25lIE9uZSBPbmVcIixcbiAgICAgIFwiT25lIEhlbGxvXCIsXG4gICAgICBcIjIwMjItMDktMTdcIixcbiAgICAgIHRydWUsXG4gICAgICBcIm1pZGRsZVwiLFxuICAgICAgXCJQcm9qZWN0IDJcIlxuICAgICksXG4gICAgVG9kb1Rhc2soXG4gICAgICBcIlR3byBUd28gVHdvXCIsXG4gICAgICBcIlR3byBIZWxsb1wiLFxuICAgICAgXCIyMDIyLTAxLTA5XCIsXG4gICAgICBmYWxzZSxcbiAgICAgIFwiaGlnaFwiLFxuICAgICAgXCJQcm9qZWN0IDNcIlxuICAgICksXG4gICAgVG9kb1Rhc2soXG4gICAgICBcIlRocmVlIFRocmVlIFRocmVlXCIsXG4gICAgICBcIlRocmVlIEhlbGxvXCIsXG4gICAgICBcIjIwMjItMTItMjVcIixcbiAgICAgIGZhbHNlLFxuICAgICAgXCJoaWdoXCIsXG4gICAgICBcIkFsbFwiXG4gICAgKSxcbiAgXSxcbiAgcHJvamVjdHM6IFtQcm9qZWN0KFwiQWxsXCIpLCBQcm9qZWN0KFwiUHJvamVjdCAyXCIpLCBQcm9qZWN0KFwiUHJvamVjdCAzXCIpXSxcbn07XG5cbi8vIGNvbnN0IGFkZE5ld1RvZG8gPSAoZnVuY3Rpb24gKCkge1xuLy8gICBjb25zdCB0b2RvQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50b2RvLWNvbnRhaW5lclwiKTtcblxuLy8gICBjb25zdCBhZGROZXdUb2RvVmlldyA9ICgpID0+IHtcbi8vICAgICBjb25zdCBodG1sID0gYFxuLy8gICAgIDxkaXYgY2xhc3M9XCJyb3cgbS00IHAtMiByb3VuZGVkIHRvZG8tbmV3LXRhc2tcIiBpZD1cInRvZG8taG92ZXJcIj5cbi8vICAgICAgIDxkaXZcbi8vICAgICAgICAgY2xhc3M9XCJjb2wtbWQtMSBweS0xIGQtZmxleCBqdXN0aWZ5LWNvbnRlbnQtbWQtZW5kIGp1c3RpZnktY29udGVudC1jZW50ZXIgYWxpZ24taXRlbXMtY2VudGVyXCJcbi8vICAgICAgID5cbi8vICAgICAgICAgPGE+XG4vLyAgICAgICAgICAgPGltZ1xuLy8gICAgICAgICAgICAgY2xhc3M9XCJcIlxuLy8gICAgICAgICAgICAgd2lkdGg9XCIxNlwiXG4vLyAgICAgICAgICAgICBoZWlnaHQ9XCIxNlwiXG4vLyAgICAgICAgICAgICBzcmM9XCIuLi9pY29ucy9wbHVzLWNpcmNsZS5zdmdcIlxuLy8gICAgICAgICAgIC8+XG4vLyAgICAgICAgIDwvYT5cbi8vICAgICAgIDwvZGl2PlxuLy8gICAgICAgPGRpdlxuLy8gICAgICAgICBjbGFzcz1cImNvbC1tZC03IGQtZmxleCBhbGlnbi1pdGVtcy1jZW50ZXIganVzdGlmeS1jb250ZW50LW1kLXN0YXJ0IGp1c3RpZnktY29udGVudC1jZW50ZXJcIlxuLy8gICAgICAgPlxuLy8gICAgICAgICBBZGQgYSBuZXcgdGFzayFcbi8vICAgICAgIDwvZGl2PlxuLy8gICAgIDwvZGl2PmA7XG4vLyAgICAgY29uc3QgbmV3RWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4vLyAgICAgbmV3RWxlbWVudC5jbGFzc0xpc3QgPSBcImhvdmVyLXRvZG8tbmV3LXRhc2tcIjtcbi8vICAgICBuZXdFbGVtZW50LmlubmVySFRNTCA9IGh0bWw7XG4vLyAgICAgcmV0dXJuIG5ld0VsZW1lbnQ7XG4vLyAgIH07XG4vLyAgIHJldHVybiB7IGFkZE5ld1RvZG9WaWV3IH07XG4vLyB9KSgpO1xuXG4vLyBhZGROZXdUb2RvLmFkZE5ld1RvZG9WaWV3KCk7XG5cbmNvbnN0IG1lbnVDb250cm9sbGVyID0gKGZ1bmN0aW9uICgpIHtcbiAgY29uc3Qgc2lkZWJhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2lkZWJhclwiKTtcblxuICBzaWRlYmFyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZlbnQpID0+IHtcbiAgICByZW1vdmVBY3RpdmUoKTtcbiAgICBpZiAoZXZlbnQudGFyZ2V0LmNsb3Nlc3QoXCJhXCIpID09PSBudWxsKSByZXR1cm47XG4gICAgZXZlbnQudGFyZ2V0LmNsb3Nlc3QoXCJhXCIpLmNsYXNzTGlzdC5hZGQoXCJhY3RpdmVcIik7XG4gIH0pO1xufSkoKTtcblxuZnVuY3Rpb24gcmVtb3ZlQWN0aXZlKCkge1xuICBsZXQgYnV0dG9ucyA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tZW51LWJ1dHRvblwiKSk7XG4gIGJ1dHRvbnMuZm9yRWFjaCgoYnV0dG9uKSA9PiBidXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImFjdGl2ZVwiKSk7XG59XG5cbmNvbnN0IHByb2plY3RNb2RhbCA9IChmdW5jdGlvbiAoKSB7XG4gIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9qZWN0LW1vZGFsXCIpO1xuICBjb25zdCBvcGVuTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm5ldy1wcm9qZWN0LWJ1dHRvblwiKTtcbiAgY29uc3QgY2xvc2VNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvamVjdC1tb2RhbC1jbG9zZVwiKTtcbiAgY29uc3Qgc3VibWl0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9qZWN0LXN1Ym1pdFwiKTtcbiAgY29uc3QgZm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibmV3LXByb2plY3QtZm9ybVwiKTtcblxuICBvcGVuTW9kYWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICBzaG93TW9kYWwoKTtcbiAgfSk7XG5cbiAgY2xvc2VNb2RhbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIGhpZGVNb2RhbCgpO1xuICB9KTtcblxuICBzdWJtaXQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldmVudCkgPT4ge1xuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgY29uc3QgdGl0bGUgPSBmb3JtW1widGl0bGVcIl07XG4gICAgY29uc3QgdGl0bGVWYWxpZCA9IHByb2plY3RNb2RhbFZhbGlkYXRpb24uY2hlY2tUaXRsZSh0aXRsZSk7XG4gICAgaWYgKHRpdGxlVmFsaWQpIHtcbiAgICAgIC8vIGNyZWF0ZSBwcm9qZWN0XG4gICAgICBjb25zdCBuZXdQcm9qZWN0ID0gUHJvamVjdCh0aXRsZS52YWx1ZSk7XG4gICAgICAvLyBwdXNoIHByb2plY3QgdG8gc3RvcmFnZVxuICAgICAgbW9kZWwucHJvamVjdHMucHVzaChuZXdQcm9qZWN0KTtcbiAgICAgIC8vIHJlbmRlciBwcm9qZWN0XG4gICAgICBwcm9qZWN0TWVudVZpZXcuYWRkUHJvamVjdFRvVmlldyhuZXdQcm9qZWN0KTtcbiAgICAgIC8vIGNsZWFyIGZvcm1cbiAgICAgIHByb2plY3RNb2RhbFZhbGlkYXRpb24uY2xlYXJGb3JtKGZvcm0pO1xuICAgICAgLy8gY2xvc2UgbW9kYWxcbiAgICAgIGhpZGVNb2RhbCgpO1xuICAgIH1cbiAgfSk7XG5cbiAgY29uc3Qgc2hvd01vZGFsID0gZnVuY3Rpb24gKCkge1xuICAgIG1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoXCJoaWRlXCIpO1xuICAgIG1vZGFsLmNsYXNzTGlzdC5hZGQoXCJzaG93XCIpO1xuICB9O1xuXG4gIGNvbnN0IGhpZGVNb2RhbCA9IGZ1bmN0aW9uICgpIHtcbiAgICBtb2RhbC5jbGFzc0xpc3QucmVtb3ZlKFwic2hvd1wiKTtcbiAgICBtb2RhbC5jbGFzc0xpc3QuYWRkKFwiaGlkZVwiKTtcbiAgfTtcbn0pKCk7XG5cbmNvbnN0IHByb2plY3RNb2RhbFZhbGlkYXRpb24gPSAoZnVuY3Rpb24gKCkge1xuICBjb25zdCBpc1JlcXVpcmVkID0gKHZhbHVlKSA9PiB7XG4gICAgcmV0dXJuIHZhbHVlID09PSBcIlwiO1xuICB9O1xuXG4gIGNvbnN0IHNob3dFcnJvciA9IChpbnB1dCwgbWVzc2FnZSkgPT4ge1xuICAgIGlucHV0LmNsYXNzTGlzdC5hZGQoXCJlcnJvclwiKTtcbiAgfTtcblxuICBjb25zdCBzaG93U3VjY2VzcyA9IChpbnB1dCkgPT4ge1xuICAgIGlucHV0LmNsYXNzTGlzdC5yZW1vdmUoXCJlcnJvclwiKTtcbiAgfTtcblxuICBjb25zdCBjaGVja1RpdGxlID0gKGVsZW1lbnQpID0+IHtcbiAgICBsZXQgdmFsaWQgPSBmYWxzZTtcbiAgICBjb25zdCB0aXRsZSA9IGVsZW1lbnQudmFsdWUudHJpbSgpO1xuICAgIGlmIChpc1JlcXVpcmVkKHRpdGxlKSkge1xuICAgICAgc2hvd0Vycm9yKGVsZW1lbnQsIFwiVGl0bGUgY2Fubm90IGJlIGVtcHR5LlwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc2hvd1N1Y2Nlc3MoZWxlbWVudCk7XG4gICAgICB2YWxpZCA9IHRydWU7XG4gICAgfVxuICAgIHJldHVybiB2YWxpZDtcbiAgfTtcblxuICBjb25zdCBjbGVhckZvcm0gPSAoZm9ybSkgPT4ge1xuICAgIGZvcm1bXCJ0aXRsZVwiXS52YWx1ZSA9IFwiXCI7XG4gIH07XG4gIHJldHVybiB7IGNoZWNrVGl0bGUsIGNsZWFyRm9ybSB9O1xufSkoKTtcblxuY29uc3QgcHJvamVjdE1lbnVWaWV3ID0gKGZ1bmN0aW9uICgpIHtcbiAgLy8gYWRkTmV3VG9kby5hZGROZXdUb2RvVmlldygpO1xuICBjb25zdCBwcm9qZWN0TWVudSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvamVjdC1tZW51XCIpO1xuICBjb25zdCBmb3JtUHJvamVjdExpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmZvcm0tcHJvamVjdC1zZWxlY3RvclwiKTtcblxuICBjb25zdCBhZGRQcm9qZWN0VG9WaWV3ID0gKHByb2plY3QpID0+IHtcbiAgICBwcm9qZWN0TWVudS5hcHBlbmRDaGlsZChjcmVhdGVQcm9qZWN0Q29tcG9uZW50KHByb2plY3QpKTtcbiAgfTtcblxuICBjb25zdCBjcmVhdGVQcm9qZWN0Q29tcG9uZW50ID0gKHByb2plY3QpID0+IHtcbiAgICBjb25zdCBodG1sID0gYFxuICAgICAgPGEgaHJlZj1cIiNcIiBjbGFzcz1cIm5hdi1saW5rIG1lbnUtYnV0dG9uIGxpbmstZGFyayByb3VuZGVkXCI+XG4gICAgICAgIDxpbWdcbiAgICAgICAgICBjbGFzcz1cImJpIG1lLTJcIlxuICAgICAgICAgIHdpZHRoPVwiMTZcIlxuICAgICAgICAgIGhlaWdodD1cIjE2XCJcbiAgICAgICAgICBzcmM9XCIuLi9pY29ucy9hcnJvdy1yaWdodC1zaG9ydC5zdmdcIlxuICAgICAgICAvPjxzcGFuIGNsYXNzPVwiZC1ub25lIGQtc20taW5saW5lXCI+JHtwcm9qZWN0LnRpdGxlfTwvc3Bhbj48L2FcbiAgICAgID5gO1xuICAgIGNvbnN0IG5ld0VsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGlcIik7XG4gICAgbmV3RWxlbWVudC5jbGFzc0xpc3QgPSBcIm5hdi1pdGVtIG0tMVwiO1xuICAgIG5ld0VsZW1lbnQuaW5uZXJIVE1MID0gaHRtbDtcbiAgICByZXR1cm4gbmV3RWxlbWVudDtcbiAgfTtcblxuICBjb25zdCBhZGRQcm9qZWN0VG9Ub2RvU2VsZWN0b3JGb3JtID0gKCkgPT4ge1xuICAgIGxldCBodG1sID0gXCJcIjtcbiAgICBtb2RlbC5wcm9qZWN0cy5mb3JFYWNoKChwcm9qZWN0KSA9PiB7XG4gICAgICBodG1sICs9IGA8b3B0aW9uPiR7cHJvamVjdC50aXRsZX08L29wdGlvbj5gO1xuICAgIH0pO1xuICAgIGZvcm1Qcm9qZWN0TGlzdC5pbm5lckhUTUwgPSBodG1sO1xuICB9O1xuICByZXR1cm4geyBhZGRQcm9qZWN0VG9WaWV3LCBhZGRQcm9qZWN0VG9Ub2RvU2VsZWN0b3JGb3JtIH07XG59KSgpO1xuXG5jb25zdCB0b2RvTW9kYWwgPSAoZnVuY3Rpb24gKCkge1xuICAvLyBhZGROZXdUb2RvLmFkZE5ld1RvZG9WaWV3KCk7XG4gIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50YXNrLW1vZGFsXCIpO1xuICBjb25zdCBvcGVuTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRvZG8tbmV3LXRhc2tcIik7XG4gIGNvbnN0IGNsb3NlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRvZG8tbW9kYWwtY2xvc2VcIik7XG4gIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm5ldy10b2RvLWZvcm1cIik7XG4gIGNvbnN0IHN1Ym1pdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudG9kby1zdWJtaXRcIik7XG4gIGNvbnNvbGUubG9nKG9wZW5Nb2RhbCk7XG5cbiAgb3Blbk1vZGFsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgcHJvamVjdE1lbnVWaWV3LmFkZFByb2plY3RUb1RvZG9TZWxlY3RvckZvcm0oKTtcbiAgICBvcGVuKCk7XG4gIH0pO1xuXG4gIGNsb3NlTW9kYWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICBjbG9zZSgpO1xuICB9KTtcblxuICBzdWJtaXQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldmVudCkgPT4ge1xuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgY29uc3QgZm9ybVByb2plY3RTZWxlY3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmZvcm0tcHJvamVjdC1zZWxlY3RvclwiKTtcblxuICAgIC8vIGdldCBmb3JtIGVsZW1lbnRzXG4gICAgY29uc3QgdGl0bGUgPSBmb3JtW1widGl0bGVcIl07XG4gICAgY29uc3QgZGVzY3JpcHRpb24gPSBmb3JtW1wiZGVzY3JpcHRpb25cIl07XG4gICAgY29uc3QgZHVlRGF0ZSA9IGZvcm1bXCJkdWVEYXRlXCJdO1xuICAgIGNvbnN0IHByb2plY3QgPVxuICAgICAgZm9ybVByb2plY3RTZWxlY3Qub3B0aW9uc1tmb3JtUHJvamVjdFNlbGVjdC5zZWxlY3RlZEluZGV4XS52YWx1ZTtcbiAgICBjb25zdCBwcmlvcml0eSA9IGZvcm1bXCJvcHRyYWRpb1wiXS52YWx1ZTtcblxuICAgIC8vIHZhbGlkYXRlIGZvcm0gZWxlbWVudHNcbiAgICBsZXQgdGl0bGVWYWxpZCA9IHRvZG9Nb2RhbFZhbGlkYXRpb24uY2hlY2tUaXRsZSh0aXRsZSksXG4gICAgICBkZXNjcmlwdGlvblZhbGlkID0gdG9kb01vZGFsVmFsaWRhdGlvbi5jaGVja0Rlc2NyaXB0aW9uKGRlc2NyaXB0aW9uKSxcbiAgICAgIGRhdGVWYWxpZCA9IHRvZG9Nb2RhbFZhbGlkYXRpb24uY2hlY2tEYXRlKGR1ZURhdGUpO1xuXG4gICAgbGV0IGlzRm9ybVZhbGlkID0gdGl0bGVWYWxpZCAmJiBkZXNjcmlwdGlvblZhbGlkICYmIGRhdGVWYWxpZDtcbiAgICAvLyBjb25zdCB0aXRsZVZhbGlkID0gcHJvamVjdE1vZGFsVmFsaWRhdGlvbi5jaGVja1RpdGxlKHRpdGxlKTtcbiAgICBpZiAoaXNGb3JtVmFsaWQpIHtcbiAgICAgIC8vIGNyZWF0ZSB0b2RvXG4gICAgICBjb25zdCBuZXdUb2RvID0gVG9kb1Rhc2soXG4gICAgICAgIHRpdGxlLnZhbHVlLFxuICAgICAgICBkZXNjcmlwdGlvbi52YWx1ZSxcbiAgICAgICAgZHVlRGF0ZS52YWx1ZSxcbiAgICAgICAgZmFsc2UsXG4gICAgICAgIHByaW9yaXR5LFxuICAgICAgICBwcm9qZWN0XG4gICAgICApO1xuICAgICAgLy8gcHVzaCB0b2RvIHRvIHN0b3JhZ2VcbiAgICAgIG1vZGVsLnRhc2tzLnB1c2gobmV3VG9kbyk7XG4gICAgICAvLyByZW5kZXIgdG9kb1xuICAgICAgdG9kb1ZpZXcuYWRkVG9kb1RvVmlldyhuZXdUb2RvKTtcbiAgICAgIC8vIGNsZWFyIGZvcm1cbiAgICAgIHRvZG9Nb2RhbFZhbGlkYXRpb24uY2xlYXJGb3JtKGZvcm0pO1xuICAgICAgLy8gY2xvc2UgbW9kYWxcbiAgICAgIGNsb3NlKCk7XG4gICAgfVxuICB9KTtcblxuICBjb25zdCBvcGVuID0gKCkgPT4ge1xuICAgIG1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoXCJoaWRlXCIpO1xuICAgIG1vZGFsLmNsYXNzTGlzdC5hZGQoXCJzaG93XCIpO1xuICB9O1xuXG4gIGNvbnN0IGNsb3NlID0gKCkgPT4ge1xuICAgIG1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoXCJzaG93XCIpO1xuICAgIG1vZGFsLmNsYXNzTGlzdC5hZGQoXCJoaWRlXCIpO1xuICB9O1xufSkoKTtcblxuY29uc3QgdG9kb01vZGFsVmFsaWRhdGlvbiA9IChmdW5jdGlvbiAoKSB7XG4gIGNvbnN0IGlzUmVxdWlyZWQgPSAodmFsdWUpID0+IHtcbiAgICByZXR1cm4gdmFsdWUgPT09IFwiXCI7XG4gIH07XG5cbiAgY29uc3Qgbm90SW5GdXR1cmUgPSAodmFsdWUpID0+IHtcbiAgICBjb25zdCB0YXNrRGF0ZSA9IG5ldyBEYXRlKGAke3ZhbHVlfWApO1xuICAgIGNvbnN0IFt5ZWFyLCBtb250aCwgZGF5XSA9IHZhbHVlLnNwbGl0KFwiLVwiKTtcbiAgICBjb25zdCBjdXJyZW50RGF0ZSA9IG5ldyBEYXRlKCk7XG4gICAgY29uc3QgY0RheSA9IGN1cnJlbnREYXRlLmdldERhdGUoKTtcbiAgICBjb25zdCBjTW9udGggPSBjdXJyZW50RGF0ZS5nZXRNb250aCgpICsgMTtcbiAgICBjb25zdCBjWWVhciA9IGN1cnJlbnREYXRlLmdldEZ1bGxZZWFyKCk7XG5cbiAgICBpZiAoK3llYXIgPT09IGNZZWFyICYmICttb250aCA9PT0gY01vbnRoICYmICtkYXkgPT09IGNEYXkpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuICEodGFza0RhdGUgPiBjdXJyZW50RGF0ZSk7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IHNob3dUaXRsZUVycm9yID0gKGlucHV0LCBtZXNzYWdlKSA9PiB7XG4gICAgY29uc3QgZXJyb3IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRpdGxlRXJyb3JcIik7XG4gICAgZXJyb3IudGV4dENvbnRlbnQgPSBtZXNzYWdlO1xuICB9O1xuXG4gIGNvbnN0IHNob3dEZXNjRXJyb3IgPSAoaW5wdXQsIG1lc3NhZ2UpID0+IHtcbiAgICBjb25zdCBlcnJvciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZGVzY0Vycm9yXCIpO1xuICAgIGVycm9yLnRleHRDb250ZW50ID0gbWVzc2FnZTtcbiAgfTtcbiAgY29uc3Qgc2hvd0RhdGVFcnJvciA9IChpbnB1dCwgbWVzc2FnZSkgPT4ge1xuICAgIGNvbnN0IGVycm9yID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5kYXRlRXJyb3JcIik7XG4gICAgZXJyb3IudGV4dENvbnRlbnQgPSBtZXNzYWdlO1xuICB9O1xuXG4gIGNvbnN0IHNob3dUaXRsZVN1Y2Nlc3MgPSAoaW5wdXQsIG1lc3NhZ2UpID0+IHtcbiAgICBjb25zdCBlcnJvciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudGl0bGVFcnJvclwiKTtcbiAgICBlcnJvci50ZXh0Q29udGVudCA9IFwiXCI7XG4gIH07XG5cbiAgY29uc3Qgc2hvd0Rlc2NTdWNjZXNzID0gKGlucHV0LCBtZXNzYWdlKSA9PiB7XG4gICAgY29uc3QgZXJyb3IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmRlc2NFcnJvclwiKTtcbiAgICBlcnJvci50ZXh0Q29udGVudCA9IFwiXCI7XG4gIH07XG4gIGNvbnN0IHNob3dEYXRlU3VjY2VzcyA9IChpbnB1dCwgbWVzc2FnZSkgPT4ge1xuICAgIGNvbnN0IGVycm9yID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5kYXRlRXJyb3JcIik7XG4gICAgZXJyb3IudGV4dENvbnRlbnQgPSBcIlwiO1xuICB9O1xuXG4gIGNvbnN0IGNoZWNrVGl0bGUgPSAoZWxlbWVudCkgPT4ge1xuICAgIGxldCB2YWxpZCA9IGZhbHNlO1xuICAgIGNvbnN0IHRpdGxlID0gZWxlbWVudC52YWx1ZS50cmltKCk7XG4gICAgaWYgKGlzUmVxdWlyZWQodGl0bGUpKSB7XG4gICAgICBzaG93VGl0bGVFcnJvcihlbGVtZW50LCBcIlRpdGxlIGNhbm5vdCBiZSBlbXB0eS5cIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNob3dUaXRsZVN1Y2Nlc3MoZWxlbWVudCk7XG4gICAgICB2YWxpZCA9IHRydWU7XG4gICAgfVxuICAgIHJldHVybiB2YWxpZDtcbiAgfTtcblxuICBjb25zdCBjaGVja0Rlc2NyaXB0aW9uID0gKGVsZW1lbnQpID0+IHtcbiAgICBsZXQgdmFsaWQgPSBmYWxzZTtcbiAgICBjb25zdCBkZXNjcmlwdGlvbiA9IGVsZW1lbnQudmFsdWUudHJpbSgpO1xuICAgIGlmIChpc1JlcXVpcmVkKGRlc2NyaXB0aW9uKSkge1xuICAgICAgc2hvd0Rlc2NFcnJvcihlbGVtZW50LCBcIkRlc2NyaXB0aW9uIGNhbm5vdCBiZSBlbXB0eS5cIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNob3dEZXNjU3VjY2VzcyhlbGVtZW50KTtcbiAgICAgIHZhbGlkID0gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIHZhbGlkO1xuICB9O1xuXG4gIGNvbnN0IGNoZWNrRGF0ZSA9IChlbGVtZW50KSA9PiB7XG4gICAgbGV0IHZhbGlkID0gZmFsc2U7XG4gICAgY29uc3QgZHVlRGF0ZSA9IGVsZW1lbnQudmFsdWUudHJpbSgpO1xuICAgIGlmIChpc1JlcXVpcmVkKGR1ZURhdGUpKSB7XG4gICAgICBzaG93RGF0ZUVycm9yKGVsZW1lbnQsIFwiRHVlIGRhdGUgY2Fubm90IGJlIGVtcHR5XCIpO1xuICAgIH1cbiAgICBpZiAobm90SW5GdXR1cmUoZHVlRGF0ZSkpIHtcbiAgICAgIHNob3dEYXRlRXJyb3IoZWxlbWVudCwgXCJEdWUgZGF0ZSBtdXN0IGJlIGluIHRoZSBmdXR1cmUuXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzaG93RGF0ZVN1Y2Nlc3MoZWxlbWVudCk7XG4gICAgICB2YWxpZCA9IHRydWU7XG4gICAgfVxuICAgIHJldHVybiB2YWxpZDtcbiAgfTtcblxuICBjb25zdCBjbGVhckZvcm0gPSAoZm9ybSkgPT4ge1xuICAgIGZvcm1bXCJ0aXRsZVwiXS52YWx1ZSA9IFwiXCI7XG4gICAgZm9ybVtcImRlc2NyaXB0aW9uXCJdLnZhbHVlID0gXCJcIjtcbiAgICBmb3JtW1wiZHVlRGF0ZVwiXS52YWx1ZSA9IFwiXCI7XG4gIH07XG4gIHJldHVybiB7IGNoZWNrVGl0bGUsIGNoZWNrRGVzY3JpcHRpb24sIGNoZWNrRGF0ZSwgY2xlYXJGb3JtIH07XG59KSgpO1xuXG5jb25zdCB0b2RvVmlldyA9IChmdW5jdGlvbiAoKSB7XG4gIGNvbnN0IHRvZG9Db250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRvZG8tY29udGFpbmVyXCIpO1xuXG4gIGNvbnN0IHJlbW92ZUFsbFRhc2tzID0gKCkgPT4ge1xuICAgIHdoaWxlICh0b2RvQ29udGFpbmVyLmZpcnN0Q2hpbGQpIHtcbiAgICAgIHRvZG9Db250YWluZXIucmVtb3ZlQ2hpbGQodG9kb0NvbnRhaW5lci5sYXN0Q2hpbGQpO1xuICAgIH1cbiAgICAvLyB0b2RvQ29udGFpbmVyLmFwcGVuZENoaWxkKGFkZE5ld1RvZG9CdXR0b25Ub1ZpZXcoKSk7XG4gIH07XG5cbiAgLy8gY29uc3QgYWRkTmV3VG9kb0J1dHRvblRvVmlldyA9ICgpID0+IHtcbiAgLy8gICBjb25zdCBodG1sID0gYFxuICAvLyAgIDxkaXYgY2xhc3M9XCJyb3cgbS00IHAtMiByb3VuZGVkIHRvZG8tbmV3LXRhc2tcIiBpZD1cInRvZG8taG92ZXJcIj5cbiAgLy8gICAgIDxkaXZcbiAgLy8gICAgICAgY2xhc3M9XCJjb2wtbWQtMSBweS0xIGQtZmxleCBqdXN0aWZ5LWNvbnRlbnQtbWQtZW5kIGp1c3RpZnktY29udGVudC1jZW50ZXIgYWxpZ24taXRlbXMtY2VudGVyXCJcbiAgLy8gICAgID5cbiAgLy8gICAgICAgPGE+XG4gIC8vICAgICAgICAgPGltZ1xuICAvLyAgICAgICAgICAgY2xhc3M9XCJcIlxuICAvLyAgICAgICAgICAgd2lkdGg9XCIxNlwiXG4gIC8vICAgICAgICAgICBoZWlnaHQ9XCIxNlwiXG4gIC8vICAgICAgICAgICBzcmM9XCIuLi9pY29ucy9wbHVzLWNpcmNsZS5zdmdcIlxuICAvLyAgICAgICAgIC8+XG4gIC8vICAgICAgIDwvYT5cbiAgLy8gICAgIDwvZGl2PlxuICAvLyAgICAgPGRpdlxuICAvLyAgICAgICBjbGFzcz1cImNvbC1tZC03IGQtZmxleCBhbGlnbi1pdGVtcy1jZW50ZXIganVzdGlmeS1jb250ZW50LW1kLXN0YXJ0IGp1c3RpZnktY29udGVudC1jZW50ZXJcIlxuICAvLyAgICAgPlxuICAvLyAgICAgICBBZGQgYSBuZXcgdGFzayFcbiAgLy8gICAgIDwvZGl2PlxuICAvLyAgIDwvZGl2PmA7XG4gIC8vICAgY29uc3QgbmV3RWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIC8vICAgbmV3RWxlbWVudC5jbGFzc0xpc3QgPSBcImhvdmVyLXRvZG8tbmV3LXRhc2tcIjtcbiAgLy8gICBuZXdFbGVtZW50LmlubmVySFRNTCA9IGh0bWw7XG4gIC8vICAgcmV0dXJuIG5ld0VsZW1lbnQ7XG4gIC8vIH07XG5cbiAgY29uc3QgYWRkVG9kb1RvVmlldyA9ICh0b2RvKSA9PiB7XG4gICAgLy8gY29uc3QgZmlyc3RDaGlsZCA9IHRvZG9Db250YWluZXIuZmlyc3RFbGVtZW50Q2hpbGQ7XG4gICAgLy8gZmlyc3RDaGlsZC5pbnNlcnRBZGphY2VudEVsZW1lbnQoXCJiZWZvcmViZWdpblwiLCBjcmVhdGVUb2RvQ29tcG9uZW50KHRvZG8pKTtcbiAgICB0b2RvQ29udGFpbmVyLmFwcGVuZENoaWxkKGNyZWF0ZVRvZG9Db21wb25lbnQodG9kbykpO1xuICB9O1xuXG4gIGNvbnN0IGNyZWF0ZVRvZG9Db21wb25lbnQgPSAodG9kbykgPT4ge1xuICAgIGNvbnN0IGh0bWwgPSBgXG4gICAgPGRpdlxuICAgIGNsYXNzPVwiY29sLW1kLTEgcHktMSBkLWZsZXgganVzdGlmeS1jb250ZW50LW1kLWVuZCBqdXN0aWZ5LWNvbnRlbnQtY2VudGVyXCJcbiAgPlxuICAgIDxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBjbGFzcz1cInRhc2stY2hlY2tib3hcIiAke1xuICAgICAgdG9kby5jb21wbGV0ZWQgPyBcImNoZWNrZWRcIiA6IFwiXCJcbiAgICB9Lz5cbiAgPC9kaXY+XG4gIDxkaXZcbiAgICBjbGFzcz1cImNvbC1tZC02IGQtZmxleCBhbGlnbi1pdGVtcy1jZW50ZXIganVzdGlmeS1jb250ZW50LW1kLXN0YXJ0IGp1c3RpZnktY29udGVudC1jZW50ZXJcIlxuICA+XG4gICAgJHt0b2RvLmNvbXBsZXRlZCA/IGA8ZGVsPiR7dG9kby50aXRsZX08L2RlbD5gIDogYCR7dG9kby50aXRsZX1gfVxuICA8L2Rpdj5cbiAgICA8ZGl2XG4gICAgICAgIGNsYXNzPVwiY29sLW1kLTEgZC1mbGV4IGFsaWduLWl0ZW1zLWNlbnRlciBqdXN0aWZ5LW1kLXN0YXJ0IGp1c3RpZnktY29udGVudC1jZW50ZXIgdGFzay1hcnJvd1wiXG4gICAgICAgICA+XG4gICAgICAgIDxpbWdcbiAgICAgICAgIGNsYXNzPVwidGFzay1hcnJvdy1pbWFnZS1kb3duXCJcbiAgICAgICAgIHdpZHRoPVwiMTZcIlxuICAgICAgICAgaGVpZ2h0PVwiMTZcIlxuICAgICAgICAgc3JjPVwiLi4vaWNvbnMvY2FyZXQtZG93bi5zdmdcIlxuICAgICAgICAgLz5cbiAgICA8L2Rpdj5cbiAgPGRpdlxuICAgIGNsYXNzPVwiY29sLW1kLTIgZC1mbGV4IGFsaWduLWl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNvbnRlbnQtbWQtc3RhcnQganVzdGlmeS1jb250ZW50LWNlbnRlclwiXG4gID5cbiAgICAke3RvZG8uZHVlRGF0ZX1cbiAgPC9kaXY+XG4gIDxkaXZcbiAgICBjbGFzcz1cImNvbC1tZC0xIGQtZmxleCBhbGlnbi1pdGVtcy1jZW50ZXIganVzdGlmeS1tZC1zdGFydCBqdXN0aWZ5LWNvbnRlbnQtY2VudGVyXCJcbiAgPlxuICAgICAgPGltZ1xuICAgICAgICBjbGFzcz1cInRhc2stZWRpdFwiXG4gICAgICAgIHdpZHRoPVwiMTZcIlxuICAgICAgICBoZWlnaHQ9XCIxNlwiXG4gICAgICAgIHNyYz1cIi4uL2ljb25zL3BlbmNpbC1zcXVhcmUuc3ZnXCJcbiAgICAgIC8+XG5cbiAgPC9kaXY+XG4gIDxkaXZcbiAgICBjbGFzcz1cImNvbC1tZC0xIGQtZmxleCBhbGlnbi1pdGVtcy1jZW50ZXIganVzdGlmeS1tZC1zdGFydCBqdXN0aWZ5LWNvbnRlbnQtY2VudGVyXCJcbiAgPlxuICAgICAgPGltZ1xuICAgICAgICBjbGFzcz1cInRhc2stZGVsZXRlXCJcbiAgICAgICAgd2lkdGg9XCIxNlwiXG4gICAgICAgIGhlaWdodD1cIjE2XCJcbiAgICAgICAgc3JjPVwiLi4vaWNvbnMvdHJhc2guc3ZnXCJcbiAgICAgIC8+XG4gIDwvZGl2PmA7XG4gICAgY29uc3QgbmV3RWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgbmV3RWxlbWVudC5jbGFzc0xpc3QgPSBgcm93IG0tNCBwLTIgYmctd2hpdGUgcm91bmRlZC0zIGJvcmRlci1ib3R0b20gICR7XG4gICAgICB0b2RvLnByaW9yaXR5ID09PSBcImhpZ2hcIlxuICAgICAgICA/IFwicmVkLWJvcmRlclwiXG4gICAgICAgIDogdG9kby5wcmlvcml0eSA9PT0gXCJtaWRkbGVcIlxuICAgICAgICA/IFwib3JhbmdlLWJvcmRlclwiXG4gICAgICAgIDogXCJncmVlbi1ib3JkZXJcIlxuICAgIH1gO1xuICAgIG5ld0VsZW1lbnQuaW5uZXJIVE1MID0gaHRtbDtcbiAgICByZXR1cm4gbmV3RWxlbWVudDtcbiAgfTtcblxuICByZXR1cm4geyBhZGRUb2RvVG9WaWV3LCByZW1vdmVBbGxUYXNrcyB9O1xufSkoKTtcblxuY29uc3QgdGFza3NMaXN0ZW5lciA9IChmdW5jdGlvbiAoKSB7XG4gIGNvbnN0IHRvZG9NYWluQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50b2RvLW1haW4tY29udGFpbmVyXCIpO1xuICAvLyAgIGNvbnN0IHRvZG9Db250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRvZG8tY29udGFpbmVyXCIpO1xuXG4gIHRvZG9NYWluQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZlbnQpID0+IHtcbiAgICBjb25zdCBjaGVja2JveENvbnRhaW5lciA9IGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJ0YXNrLWNoZWNrYm94XCIpO1xuICAgIGNvbnN0IGFycm93Q29udGFpbmVyID1cbiAgICAgIGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJ0YXNrLWFycm93LWltYWdlLWRvd25cIikgfHxcbiAgICAgIGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJ0YXNrLWFycm93LWltYWdlLXVwXCIpO1xuICAgIGNvbnN0IGVkaXRDb250YWluZXIgPSBldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwidGFzay1lZGl0XCIpO1xuICAgIGNvbnN0IGRlbGV0ZUNvbnRhaW5lciA9IGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJ0YXNrLWRlbGV0ZVwiKTtcblxuICAgIGlmIChjaGVja2JveENvbnRhaW5lcikge1xuICAgICAgY29uc3Qgcm93ID0gQXJyYXkuZnJvbShldmVudC50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlLmNoaWxkTm9kZXMpO1xuICAgICAgY29uc3QgdGl0bGUgPSByb3dbM10udGV4dENvbnRlbnQudHJpbSgpO1xuICAgICAgY29uc3QgZGF0ZSA9IHJvd1s3XS50ZXh0Q29udGVudC50cmltKCk7XG5cbiAgICAgIGNvbnN0IHRhc2sgPSBtb2RlbC50YXNrcy5maWx0ZXIoXG4gICAgICAgICh0YXNrKSA9PiB0YXNrLnRpdGxlID09PSB0aXRsZSAmJiB0YXNrLmR1ZURhdGUgPT09IGRhdGVcbiAgICAgICk7XG4gICAgICB0YXNrWzBdLmNvbXBsZXRlZCA9ICF0YXNrWzBdLmNvbXBsZXRlZDtcbiAgICAgIGlmICh0YXNrWzBdLmNvbXBsZXRlZCkge1xuICAgICAgICByb3dbM10uaW5uZXJIVE1MID0gYDxkZWw+JHtyb3dbM10uaW5uZXJIVE1MfTwvZGVsPmA7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByb3dbM10uaW5uZXJIVE1MID0gcm93WzNdLmlubmVySFRNTC5yZXBsYWNlKC8oPChbXj5dKyk+KS9naSwgXCJcIik7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGFycm93Q29udGFpbmVyKSB7XG4gICAgICBsZXQgdGl0bGU7XG4gICAgICBsZXQgZGF0ZTtcbiAgICAgIGxldCBkaXY7XG4gICAgICBsZXQgYXJyb3c7XG5cbiAgICAgIGlmIChldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwidGFzay1hcnJvdy1pbWFnZS1kb3duXCIpKSB7XG4gICAgICAgIGNvbnN0IHJvdyA9IEFycmF5LmZyb20oZXZlbnQudGFyZ2V0LnBhcmVudE5vZGUucGFyZW50Tm9kZS5jaGlsZE5vZGVzKTtcbiAgICAgICAgbGV0IGFycm93SW1hZ2VEaXYgPSBldmVudC50YXJnZXQucGFyZW50Tm9kZTtcbiAgICAgICAgZGl2ID0gZXZlbnQudGFyZ2V0LnBhcmVudE5vZGUucGFyZW50Tm9kZTtcbiAgICAgICAgY29uc29sZS5sb2cocm93KTtcbiAgICAgICAgY29uc29sZS5sb2coZGl2KTtcbiAgICAgICAgdGl0bGUgPSByb3dbM10udGV4dENvbnRlbnQudHJpbSgpO1xuICAgICAgICBkYXRlID0gcm93WzddLnRleHRDb250ZW50LnRyaW0oKTtcbiAgICAgICAgYXJyb3dJbWFnZURpdi5pbm5lckhUTUwgPSB1cEFycm93SHRtbCgpO1xuXG4gICAgICAgIGNvbnNvbGUubG9nKHRpdGxlLCBkYXRlKTtcblxuICAgICAgICBjb25zdCB0YXNrID0gbW9kZWwudGFza3MuZmlsdGVyKFxuICAgICAgICAgICh0YXNrKSA9PiB0YXNrLnRpdGxlID09PSB0aXRsZSAmJiB0YXNrLmR1ZURhdGUgPT09IGRhdGVcbiAgICAgICAgKTtcbiAgICAgICAgY29uc29sZS5sb2codGFzayk7XG4gICAgICAgIGNvbnN0IGRlc2NEaXYgPSBjcmVhdGVEZXNjcmlwdGlvbkRpdih0YXNrKTtcbiAgICAgICAgZGl2Lmluc2VydEFkamFjZW50RWxlbWVudChcImFmdGVyZW5kXCIsIGRlc2NEaXYpO1xuICAgICAgfVxuXG4gICAgICBpZiAoZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcInRhc2stYXJyb3ctaW1hZ2UtdXBcIikpIHtcbiAgICAgICAgY29uc3Qgcm93ID0gQXJyYXkuZnJvbShldmVudC50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlLmNoaWxkTm9kZXMpO1xuICAgICAgICBsZXQgYXJyb3dJbWFnZURpdiA9IGV2ZW50LnRhcmdldC5wYXJlbnROb2RlO1xuICAgICAgICBkaXYgPSBldmVudC50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlO1xuICAgICAgICB0aXRsZSA9IHJvd1szXS50ZXh0Q29udGVudC50cmltKCk7XG4gICAgICAgIGRhdGUgPSByb3dbN10udGV4dENvbnRlbnQudHJpbSgpO1xuICAgICAgICBhcnJvd0ltYWdlRGl2LmlubmVySFRNTCA9IGRvd25BcnJvd0h0bWwoKTtcblxuICAgICAgICBkaXYubmV4dEVsZW1lbnRTaWJsaW5nLnJlbW92ZSgpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChlZGl0Q29udGFpbmVyKSB7XG4gICAgICBjb25zdCByb3cgPSBBcnJheS5mcm9tKGV2ZW50LnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGUuY2hpbGROb2Rlcyk7XG4gICAgICBsZXQgdGl0bGUgPSByb3dbM10udGV4dENvbnRlbnQudHJpbSgpO1xuICAgICAgbGV0IGRhdGUgPSByb3dbN10udGV4dENvbnRlbnQudHJpbSgpO1xuICAgICAgY29uc3QgdGFzayA9IG1vZGVsLnRhc2tzLmZpbHRlcihcbiAgICAgICAgKHRhc2spID0+IHRhc2sudGl0bGUgPT09IHRpdGxlICYmIHRhc2suZHVlRGF0ZSA9PT0gZGF0ZVxuICAgICAgKTtcbiAgICAgIGNvbnNvbGUubG9nKHRhc2spO1xuICAgICAgdG9kb0VkaXRNb2RhbC5maWxsRm9ybSh0YXNrKTtcbiAgICAgIHRvZG9FZGl0TW9kYWwub3BlbigpO1xuICAgIH1cblxuICAgIGlmIChkZWxldGVDb250YWluZXIpIHtcbiAgICAgIGNvbnN0IHJvdyA9IEFycmF5LmZyb20oZXZlbnQudGFyZ2V0LnBhcmVudE5vZGUucGFyZW50Tm9kZS5jaGlsZE5vZGVzKTtcbiAgICAgIGxldCB0aXRsZSA9IHJvd1szXS50ZXh0Q29udGVudC50cmltKCk7XG4gICAgICBsZXQgZGF0ZSA9IHJvd1s3XS50ZXh0Q29udGVudC50cmltKCk7XG4gICAgICBjb25zdCB0YXNrID0gbW9kZWwudGFza3MuZmlsdGVyKFxuICAgICAgICAodGFzaykgPT4gdGFzay50aXRsZSA9PT0gdGl0bGUgJiYgdGFzay5kdWVEYXRlID09PSBkYXRlXG4gICAgICApO1xuICAgICAgbGV0IGluZGV4O1xuICAgICAgbW9kZWwudGFza3MuZmlsdGVyKCh0LCBpKSA9PiB7XG4gICAgICAgIGlmIChcbiAgICAgICAgICB0YXNrWzBdLnRpdGxlID09PSB0LnRpdGxlICYmXG4gICAgICAgICAgdGFza1swXS5kZXNjcmlwdGlvbiA9PT0gdC5kZXNjcmlwdGlvbiAmJlxuICAgICAgICAgIHRhc2tbMF0uZHVlRGF0ZSA9PT0gdC5kdWVEYXRlXG4gICAgICAgICkge1xuICAgICAgICAgIGluZGV4ID0gaTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIG1vZGVsLnRhc2tzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICB0b2RvVmlldy5yZW1vdmVBbGxUYXNrcygpO1xuICAgICAgbW9kZWwudGFza3MuZm9yRWFjaCgodGFzaykgPT4gdG9kb1ZpZXcuYWRkVG9kb1RvVmlldyh0YXNrKSk7XG4gICAgfVxuICB9KTtcblxuICBjb25zdCB1cEFycm93SHRtbCA9ICgpID0+IHtcbiAgICBjb25zdCBodG1sID0gYFxuICAgIDxpbWdcbiAgICAgICAgY2xhc3M9XCJ0YXNrLWFycm93LWltYWdlLXVwXCJcbiAgICAgICAgd2lkdGg9XCIxNlwiXG4gICAgICAgIGhlaWdodD1cIjE2XCJcbiAgICAgICAgc3JjPVwiLi4vaWNvbnMvY2FyZXQtdXAuc3ZnXCJcbiAgICAvPmA7XG4gICAgcmV0dXJuIGh0bWw7XG4gIH07XG5cbiAgY29uc3QgZG93bkFycm93SHRtbCA9ICgpID0+IHtcbiAgICBjb25zdCBodG1sID0gYFxuICAgIDxpbWdcbiAgICAgICAgY2xhc3M9XCJ0YXNrLWFycm93LWltYWdlLWRvd25cIlxuICAgICAgICB3aWR0aD1cIjE2XCJcbiAgICAgICAgaGVpZ2h0PVwiMTZcIlxuICAgICAgICBzcmM9XCIuLi9pY29ucy9jYXJldC1kb3duLnN2Z1wiXG4gICAgLz5gO1xuICAgIHJldHVybiBodG1sO1xuICB9O1xuXG4gIGNvbnN0IGNyZWF0ZURlc2NyaXB0aW9uRGl2ID0gKHRhc2spID0+IHtcbiAgICBjb25zb2xlLmxvZyh0YXNrKTtcbiAgICBjb25zdCBodG1sID0gYFxuICAgIDxkaXYgY2xhc3M9XCJjb250YWluZXItZmx1aWQgcHktMVwiPlxuICAgICAgPGg2IGNsYXNzPVwiZnctYm9sZFwiPkRlc2NyaXB0aW9uPC9oNj5cbiAgICAgIDxwIGNsYXNzPVwiXCI+XG4gICAgICAke3Rhc2tbMF0uZGVzY3JpcHRpb259XG4gICAgICA8L3A+XG4gIDwvZGl2PmA7XG5cbiAgICBjb25zdCBkZXRhaWxzRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICBkZXRhaWxzRGl2LmNsYXNzTGlzdCA9XG4gICAgICBcIm1vZGFsLWJvZHkgbXgtNSBteS0zIGJnLWxpZ2h0IHJvdW5kZWQtMyBib3JkZXIgYm9yZGVyLXNlY29uZGFyeSBwLTMgcm91bmRlZC0zIGRlc2NyaXB0aW9uLWRpdlwiO1xuICAgIGRldGFpbHNEaXYuaW5uZXJIVE1MID0gaHRtbDtcbiAgICByZXR1cm4gZGV0YWlsc0RpdjtcbiAgfTtcblxuICByZXR1cm4ge307XG59KSgpO1xuXG5jb25zdCB0b2RvRWRpdE1vZGFsID0gKGZ1bmN0aW9uICgpIHtcbiAgY29uc3QgbW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmVkaXQtbW9kYWxcIik7XG4gIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImVkaXQtbW9kYWwtZm9ybVwiKTtcbiAgY29uc3Qgc3VibWl0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lZGl0LXN1Ym1pdFwiKTtcbiAgY29uc3QgY2FuY2VsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lZGl0LWNhbmNlbFwiKTtcbiAgbGV0IGN1cnJlbnRUYXNrO1xuXG4gIGNvbnN0IG9wZW4gPSAoKSA9PiB7XG4gICAgbW9kYWwuY2xhc3NMaXN0LnJlbW92ZShcImhpZGVcIik7XG4gICAgbW9kYWwuY2xhc3NMaXN0LmFkZChcInNob3dcIik7XG4gIH07XG5cbiAgY29uc3QgY2xvc2UgPSAoKSA9PiB7XG4gICAgbW9kYWwuY2xhc3NMaXN0LnJlbW92ZShcInNob3dcIik7XG4gICAgbW9kYWwuY2xhc3NMaXN0LmFkZChcImhpZGVcIik7XG4gIH07XG5cbiAgY29uc3QgZmlsbEZvcm0gPSAodGFzaykgPT4ge1xuICAgIGN1cnJlbnRUYXNrID0gdGFzaztcbiAgICBjb25zb2xlLmxvZyhjdXJyZW50VGFzayk7XG4gICAgZm9ybVtcInRpdGxlXCJdLnZhbHVlID0gdGFza1swXS50aXRsZTtcbiAgICBmb3JtW1wiZGVzY3JpcHRpb25cIl0udmFsdWUgPSB0YXNrWzBdLmRlc2NyaXB0aW9uO1xuICAgIGZvcm1bXCJkdWVEYXRlXCJdLnZhbHVlID0gdGFza1swXS5kdWVEYXRlO1xuICB9O1xuXG4gIGNhbmNlbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIHRvZG9Nb2RhbFZhbGlkYXRpb24uY2xlYXJGb3JtKGZvcm0pO1xuICAgIGNsb3NlKCk7XG4gIH0pO1xuXG4gIHN1Ym1pdC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2ZW50KSA9PiB7XG4gICAgY29uc29sZS5sb2coY3VycmVudFRhc2spO1xuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgY29uc3QgdGl0bGUgPSBmb3JtW1widGl0bGVcIl07XG4gICAgY29uc3QgZGVzY3JpcHRpb24gPSBmb3JtW1wiZGVzY3JpcHRpb25cIl07XG4gICAgY29uc3QgZHVlRGF0ZSA9IGZvcm1bXCJkdWVEYXRlXCJdO1xuICAgIC8vIHZhbGlkYXRlIGZvcm0gZWxlbWVudHNcbiAgICBsZXQgdGl0bGVWYWxpZCA9IHRvZG9Nb2RhbFZhbGlkYXRpb24uY2hlY2tUaXRsZSh0aXRsZSksXG4gICAgICBkZXNjcmlwdGlvblZhbGlkID0gdG9kb01vZGFsVmFsaWRhdGlvbi5jaGVja0Rlc2NyaXB0aW9uKGRlc2NyaXB0aW9uKSxcbiAgICAgIGRhdGVWYWxpZCA9IHRvZG9Nb2RhbFZhbGlkYXRpb24uY2hlY2tEYXRlKGR1ZURhdGUpO1xuXG4gICAgbGV0IGlzRm9ybVZhbGlkID0gdGl0bGVWYWxpZCAmJiBkZXNjcmlwdGlvblZhbGlkICYmIGRhdGVWYWxpZDtcbiAgICBpZiAoaXNGb3JtVmFsaWQpIHtcbiAgICAgIC8vIGNyZWF0ZSB0b2RvXG4gICAgICBjb25zdCBuZXdUb2RvID0gVG9kb1Rhc2soXG4gICAgICAgIHRpdGxlLnZhbHVlLFxuICAgICAgICBkZXNjcmlwdGlvbi52YWx1ZSxcbiAgICAgICAgZHVlRGF0ZS52YWx1ZSxcbiAgICAgICAgY3VycmVudFRhc2suY29tcGxldGVkLFxuICAgICAgICBjdXJyZW50VGFzay5wcmlvcml0eSxcbiAgICAgICAgY3VycmVudFRhc2sucHJvamVjdFxuICAgICAgKTtcblxuICAgICAgbGV0IGluZGV4O1xuICAgICAgbW9kZWwudGFza3MuZmlsdGVyKCh0LCBpKSA9PiB7XG4gICAgICAgIGlmIChcbiAgICAgICAgICBjdXJyZW50VGFza1swXS50aXRsZSA9PT0gdC50aXRsZSAmJlxuICAgICAgICAgIGN1cnJlbnRUYXNrWzBdLmRlc2NyaXB0aW9uID09PSB0LmRlc2NyaXB0aW9uICYmXG4gICAgICAgICAgY3VycmVudFRhc2tbMF0uZHVlRGF0ZSA9PT0gdC5kdWVEYXRlXG4gICAgICAgICkge1xuICAgICAgICAgIGluZGV4ID0gaTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIG1vZGVsLnRhc2tzLnNwbGljZShpbmRleCwgMSwgbmV3VG9kbyk7XG5cbiAgICAgIC8vIGNsZWFyIGZvcm1cbiAgICAgIHRvZG9Nb2RhbFZhbGlkYXRpb24uY2xlYXJGb3JtKGZvcm0pO1xuXG4gICAgICB0b2RvVmlldy5yZW1vdmVBbGxUYXNrcygpO1xuICAgICAgbW9kZWwudGFza3MuZm9yRWFjaCgodGFzaykgPT4gdG9kb1ZpZXcuYWRkVG9kb1RvVmlldyh0YXNrKSk7XG5cbiAgICAgIC8vIGNsb3NlIG1vZGFsXG4gICAgICBjbG9zZSgpO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIHsgb3BlbiwgY2xvc2UsIGZpbGxGb3JtIH07XG59KSgpO1xuXG5tb2RlbC5wcm9qZWN0cy5mb3JFYWNoKChwcm9qZWN0KSA9PiBwcm9qZWN0TWVudVZpZXcuYWRkUHJvamVjdFRvVmlldyhwcm9qZWN0KSk7XG5tb2RlbC50YXNrcy5mb3JFYWNoKCh0YXNrKSA9PiB0b2RvVmlldy5hZGRUb2RvVG9WaWV3KHRhc2spKTtcbiJdLCJuYW1lcyI6WyJUb2RvVGFzayIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJkdWVEYXRlIiwiY29tcGxldGVkIiwicHJpb3JpdHkiLCJwcm9qZWN0IiwidGFzayIsImR1ZSIsIlByb2plY3QiLCJtb2RlbCIsInRhc2tzIiwicHJvamVjdHMiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsImJ1dHRvbiIsImNsYXNzTGlzdCIsInJlbW92ZSIsInRhcmdldCIsImNsb3Nlc3QiLCJhZGQiLCJtb2RhbCIsIm9wZW5Nb2RhbCIsImNsb3NlTW9kYWwiLCJzdWJtaXQiLCJmb3JtIiwiZ2V0RWxlbWVudEJ5SWQiLCJzaG93TW9kYWwiLCJoaWRlTW9kYWwiLCJwcmV2ZW50RGVmYXVsdCIsInByb2plY3RNb2RhbFZhbGlkYXRpb24iLCJjaGVja1RpdGxlIiwibmV3UHJvamVjdCIsInZhbHVlIiwicHVzaCIsInByb2plY3RNZW51VmlldyIsImFkZFByb2plY3RUb1ZpZXciLCJjbGVhckZvcm0iLCJlbGVtZW50IiwidmFsaWQiLCJ0cmltIiwicHJvamVjdE1lbnUiLCJmb3JtUHJvamVjdExpc3QiLCJhcHBlbmRDaGlsZCIsImh0bWwiLCJuZXdFbGVtZW50IiwiY3JlYXRlRWxlbWVudCIsImlubmVySFRNTCIsImNyZWF0ZVByb2plY3RDb21wb25lbnQiLCJhZGRQcm9qZWN0VG9Ub2RvU2VsZWN0b3JGb3JtIiwidG9kb01vZGFsVmFsaWRhdGlvbiIsImNvbnNvbGUiLCJsb2ciLCJvcGVuIiwiY2xvc2UiLCJmb3JtUHJvamVjdFNlbGVjdCIsIm9wdGlvbnMiLCJzZWxlY3RlZEluZGV4IiwidGl0bGVWYWxpZCIsImRlc2NyaXB0aW9uVmFsaWQiLCJjaGVja0Rlc2NyaXB0aW9uIiwiZGF0ZVZhbGlkIiwiY2hlY2tEYXRlIiwibmV3VG9kbyIsInRvZG9WaWV3IiwiYWRkVG9kb1RvVmlldyIsImlzUmVxdWlyZWQiLCJzaG93RGF0ZUVycm9yIiwiaW5wdXQiLCJtZXNzYWdlIiwidGV4dENvbnRlbnQiLCJ0YXNrRGF0ZSIsIkRhdGUiLCJ5ZWFyIiwibW9udGgiLCJkYXkiLCJzcGxpdCIsImN1cnJlbnREYXRlIiwiY0RheSIsImdldERhdGUiLCJjTW9udGgiLCJnZXRNb250aCIsImdldEZ1bGxZZWFyIiwibm90SW5GdXR1cmUiLCJ0b2RvQ29udGFpbmVyIiwidG9kbyIsImNyZWF0ZVRvZG9Db21wb25lbnQiLCJyZW1vdmVBbGxUYXNrcyIsImZpcnN0Q2hpbGQiLCJyZW1vdmVDaGlsZCIsImxhc3RDaGlsZCIsInRvZG9FZGl0TW9kYWwiLCJjaGVja2JveENvbnRhaW5lciIsImNvbnRhaW5zIiwiYXJyb3dDb250YWluZXIiLCJlZGl0Q29udGFpbmVyIiwiZGVsZXRlQ29udGFpbmVyIiwicm93IiwicGFyZW50Tm9kZSIsImNoaWxkTm9kZXMiLCJkYXRlIiwiZmlsdGVyIiwicmVwbGFjZSIsImRpdiIsImFycm93SW1hZ2VEaXYiLCJ1cEFycm93SHRtbCIsImRlc2NEaXYiLCJjcmVhdGVEZXNjcmlwdGlvbkRpdiIsImluc2VydEFkamFjZW50RWxlbWVudCIsImRvd25BcnJvd0h0bWwiLCJuZXh0RWxlbWVudFNpYmxpbmciLCJmaWxsRm9ybSIsImluZGV4IiwidCIsImkiLCJzcGxpY2UiLCJkZXRhaWxzRGl2IiwiY2FuY2VsIiwiY3VycmVudFRhc2siXSwic291cmNlUm9vdCI6IiJ9