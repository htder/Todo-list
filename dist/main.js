(()=>{"use strict";const e=function(e,t,n,o,c,r){const s={};return s.title=e,s.description=t,s.dueDate=n,s.completed=o,s.priority=c,s.project=r,s.due=function(){return`${e} due: ${n}`},s},t=function(e){const t={};return t.title=e,t},n={tasks:[e("Hello World","one two three","2022-01-21",!1,"high","All"),e("World Hello","one two three","2022-02-01",!1,"low","Project 2"),e("One One One","one two three","2022-09-17",!1,"middle","Project 2"),e("Two Two Two","one two three","2022-01-09",!1,"high","Project 3"),e("Three Three Three","one two three","2022-12-25",!1,"high","All")],projects:[t("All"),t("Project 2"),t("Project 3")]};document.querySelector(".sidebar").addEventListener("click",(e=>{Array.from(document.querySelectorAll(".menu-button")).forEach((e=>e.classList.remove("active"))),e.target.closest("a").classList.add("active")})),function(){const e=document.querySelector(".project-modal"),r=document.querySelector(".new-project-button"),s=document.querySelector(".project-modal-close"),i=document.querySelector(".project-submit"),l=document.getElementById("new-project-form");r.addEventListener("click",(()=>{d()})),s.addEventListener("click",(()=>{a()})),i.addEventListener("click",(e=>{e.preventDefault();const r=l.title;if(o.checkTitle(r)){const e=t(r.value);n.projects.push(e),c.addProjectToView(e),o.clearForm(l),a()}}));const d=function(){e.classList.remove("hide"),e.classList.add("show")},a=function(){e.classList.remove("show"),e.classList.add("hide")}}();const o={checkTitle:e=>{let t=!1;return""===e.value.trim()?e.classList.add("error"):(e.classList.remove("error"),t=!0),t},clearForm:e=>{e.title.value=""}},c=function(){const e=document.querySelector(".project-menu"),t=document.querySelector(".form-project-selector");return{addProjectToView:t=>{e.appendChild((e=>{const t=`\n      <a href="#" class="nav-link menu-button link-dark rounded">\n        <img\n          class="bi me-2"\n          width="16"\n          height="16"\n          src="../icons/arrow-right-short.svg"\n        /><span class="d-none d-sm-inline">${e.title}</span></a\n      >`,n=document.createElement("li");return n.classList="nav-item m-1",n.innerHTML=t,n})(t))},addProjectToTodoSelectorForm:()=>{let e="";n.projects.forEach((t=>{e+=`<option>${t.title}</option>`})),t.innerHTML=e}}}(),r=(function(){const t=document.querySelector(".task-modal"),o=document.querySelector(".todo-new-task"),i=document.querySelector(".todo-modal-close"),l=document.getElementById("new-todo-form"),d=document.querySelector(".todo-submit");o.addEventListener("click",(()=>{c.addProjectToTodoSelectorForm(),a()})),i.addEventListener("click",(()=>{u()})),d.addEventListener("click",(t=>{t.preventDefault();const o=document.querySelector(".form-project-selector"),c=l.title,i=l.description,d=l.dueDate,a=o.options[o.selectedIndex].value,m=l.optradio.value;let h=r.checkTitle(c),v=r.checkDescription(i),f=r.checkDate(d);if(h&&v&&f){const t=e(c.value,i.value,d.value,!1,m,a);n.tasks.push(t),s.addTodoToView(t),r.clearForm(l),u()}}));const a=()=>{t.classList.remove("hide"),t.classList.add("show")},u=()=>{t.classList.remove("show"),t.classList.add("hide")}}(),function(){const e=e=>""===e,t=(e,t)=>{document.querySelector(".dateError").textContent=t};return{checkTitle:t=>{let n=!1;const o=t.value.trim();return e(o)?("Title cannot be empty.",document.querySelector(".titleError").textContent="Title cannot be empty."):(document.querySelector(".titleError").textContent="",n=!0),n},checkDescription:t=>{let n=!1;const o=t.value.trim();return e(o)?("Description cannot be empty.",document.querySelector(".descError").textContent="Description cannot be empty."):(document.querySelector(".descError").textContent="",n=!0),n},checkDate:n=>{let o=!1;const c=n.value.trim();return e(c)&&t(0,"Due date cannot be empty"),(e=>{const[t,n,o]=e.split("-"),c=new Date,r=c.getDate(),s=c.getMonth()+1;return!(+t>=c.getFullYear()&&+n>=s&&+o>=r)})(c)?t(0,"Due date must be in the future."):(document.querySelector(".dateError").textContent="",o=!0),o},clearForm:e=>{e.title.value="",e.description.value="",e.dueDate.value=""}}}()),s=function(){const e=document.querySelector(".todo-container");return{addTodoToView:t=>{e.firstElementChild.insertAdjacentElement("beforebegin",(e=>{const t=`\n    <div\n    class="col-md-1 py-1 d-flex justify-content-md-end justify-content-center"\n  >\n    <input type="checkbox" />\n  </div>\n  <div\n    class="col-md-6 d-flex align-items-center justify-content-md-start justify-content-center"\n  >\n    ${e.title}\n  </div>\n  <div\n    class="col-md-1 d-flex align-items-center justify-md-start justify-content-center"\n  >\n    <a href="#" class="nav-link link-dark">\n      <img\n        class=""\n        width="16"\n        height="16"\n        src="../icons/caret-down.svg"\n      />\n    </a>\n  </div>\n  <div\n    class="col-md-2 d-flex align-items-center justify-content-md-start justify-content-center"\n  >\n    ${e.dueDate}\n  </div>\n  <div\n    class="col-md-1 d-flex align-items-center justify-md-start justify-content-center"\n  >\n    <a href="#" class="nav-link link-dark">\n      <img\n        class=""\n        width="16"\n        height="16"\n        src="../icons/pencil-square.svg"\n      />\n    </a>\n  </div>\n  <div\n    class="col-md-1 d-flex align-items-center justify-md-start justify-content-center"\n  >\n    <a href="#" class="nav-link link-dark">\n      <img\n        class=""\n        width="16"\n        height="16"\n        src="../icons/trash.svg"\n      />\n    </a>\n  </div>`,n=document.createElement("div");return n.classList="row m-4 p-2 bg-white rounded-3 border-bottom",n.innerHTML=t,n})(t))}}}();n.projects.forEach((e=>c.addProjectToView(e))),n.tasks.forEach((e=>s.addTodoToView(e)))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEVBQWdCMUUsU0FBU0MsY0FBYyxtQkFrRTdDLE1BQU8sQ0FBRXVELGNBaEVjbUIsSUFDRkQsRUFBY0Usa0JBQ3RCQyxzQkFBc0IsY0FHUCxDQUFDRixJQUMzQixNQUFNdEMsRUFBTyw4UEFTWHNDLEVBQUt2RixtYUFpQkx1RixFQUFLckYsOGtCQTBCRGdELEVBQWF0QyxTQUFTdUMsY0FBYyxPQUcxQyxPQUZBRCxFQUFXN0IsVUFBWSwrQ0FDdkI2QixFQUFXRSxVQUFZSCxFQUNoQkMsR0EzRHlDd0MsQ0FBb0JILE1BTHZELEdBc0VqQjlFLEVBQU1FLFNBQVNRLFNBQVNkLEdBQVltQyxFQUFnQkMsaUJBQWlCcEMsS0FDckVJLEVBQU1DLE1BQU1TLFNBQVNiLEdBQVM2RCxFQUFTQyxjQUFjOUQsTSIsInNvdXJjZXMiOlsid2VicGFjazovL3RvZG8tbGlzdC8uL3NyYy90YXNrLmpzIiwid2VicGFjazovL3RvZG8tbGlzdC8uL3NyYy9wcm9qZWN0LmpzIiwid2VicGFjazovL3RvZG8tbGlzdC8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBUb2RvVGFzayA9IGZ1bmN0aW9uIChcbiAgdGl0bGUsXG4gIGRlc2NyaXB0aW9uLFxuICBkdWVEYXRlLFxuICBjb21wbGV0ZWQsXG4gIHByaW9yaXR5LFxuICBwcm9qZWN0XG4pIHtcbiAgY29uc3QgdGFzayA9IHt9O1xuXG4gIHRhc2sudGl0bGUgPSB0aXRsZTtcbiAgdGFzay5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uO1xuICB0YXNrLmR1ZURhdGUgPSBkdWVEYXRlO1xuICB0YXNrLmNvbXBsZXRlZCA9IGNvbXBsZXRlZDtcbiAgdGFzay5wcmlvcml0eSA9IHByaW9yaXR5O1xuICB0YXNrLnByb2plY3QgPSBwcm9qZWN0O1xuXG4gIHRhc2suZHVlID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBgJHt0aXRsZX0gZHVlOiAke2R1ZURhdGV9YDtcbiAgfTtcblxuICByZXR1cm4gdGFzaztcbn07XG5cbmV4cG9ydCB7IFRvZG9UYXNrIH07XG4iLCJjb25zdCBQcm9qZWN0ID0gZnVuY3Rpb24gKHRpdGxlKSB7XG4gIGNvbnN0IHByb2plY3QgPSB7fTtcblxuICBwcm9qZWN0LnRpdGxlID0gdGl0bGU7XG5cbiAgcmV0dXJuIHByb2plY3Q7XG59O1xuXG5leHBvcnQgeyBQcm9qZWN0IH07XG4iLCIvLyBUb2RvIExpc3QgSXRlbSBuZWVkcyBhOlxuLy8gLSBwcm9qZWN0IGJlbG9uZ3MgdG9cbi8vIC0gdGl0bGVcbi8vIC0gZGVzY3JpcHRpb25cbi8vIC0gZHVlIGRhdGVcbi8vIC0gY29tcGxldGVkIGNoZWNrIGJveFxuLy8gLSByZWQsIG9yYW5nZSBvciBncmVlbiBmb3IgZGlmZmVyZW50IHByaW9yaXRpZXNcblxuLy8gRmFjdG9yeSBmdW5jdGlvbiBmb3IgYSB0b2RvIGxpc3QgaXRlbVxuXG4vLyBQcm9qZWN0IG5lZWRzIGE6XG4vLyAtIGxpc3Qgb2YgemVybyBvciBtb3JlIHRvZG8gaXRlbXNcblxuLy8gRmFjdG9yeSBmdW5jdGlvbiBmb3IgYSBwcm9qZWN0XG5cbi8vIFZpZXdzOlxuLy8gLSBzaWRlYmFyIHZpZXdcbi8vIC0gcHJvamVjdCB2aWV3XG4vLyAtIGFsbCB0YXNrIHZpZXdcbi8vIC0gdG9kYXkncyB0YXNrcyB2aWV3XG4vLyAtIHRoaXMgd2VlaydzIHRhc2tzIHZpZXdcbi8vIC0gcHJvamVjdCdzIHRhc2tzIHZpZXdcblxuLy8gTW9kYWxzOlxuLy8gLSBlZGl0IHRvZG8gaXRlbVxuLy8gLSBjcmVhdGUgbmV3IHRvZG8gaXRlbVxuLy8gLSBjcmVhdGUgbmV3IHByb2plY3RcblxuLy8gVG9kbyBDb250cm9sbGVyOlxuLy8gLSBkZWxldGUgdG9kb1xuLy8gLSBzaG93IGVkaXQgbW9kYWxcbi8vIC0gZXhwYW5kIGRldGFpbHNcblxuLy8gUHJvamVjdCBDb250cm9sbGVyOlxuLy8gLSBkZWxldGUgcHJvamVjdFxuXG4vL1xuLy9cbi8vXG4vL1xuLy8gLy8gY2hhbmdpbmcgYWN0aXZlIGJ1dHRvbiBvbiB0aGUgbWVudVxuLy8gLy8gYWRkaW5nIHByb2plY3QgbW9kYWwgd2hlbiBuZXcgcHJvamVjdCBpcyBwcmVzc2VkXG4vLyAvLyBhZGRpbmcgbmV3IHRvZG8gdGFzayBtb2RhbCB3aGVuIGFkZCBhIG5ldyBwcm9qZWN0IGlzIHByZXNzZWRcbi8vIC8vIGRlY2lkZSBvbiBob3cgZGF0YSBmb3IgdGFza3MgaXMgc3RvcmVkXG4vLyAvLyBzdWJtaXR0aW5nIHByb2plY3QgbW9kYWwgYWRkcyBhIG5ldyBwcm9qZWN0IC0gaG93IGlzIGl0IHN0b3JlZD9cbi8vIC8vIHN1Ym1pdHRpbmcgdG9kbyB0YXNrIG1vZGFsIGFkZHMgYSBuZXcgdGFzayAtIGhvdyBpcyBpdCBzdG9yZWQ/XG4vLyBhZGQgZXZlbnQgbGlzdGVuZXJzIHRvIHRhc2tzXG4vLyBzaG93IGRldGFpbHMgc2xpZGVyIHdoZW4gZG93biBhcnJvdyBpcyBwcmVzc2VkXG4vLyBjaGFuZ2UgYXJyb3cgaWNvbiB3aGVuIGRldGFpbHMgYXJlIHNob3dpbmcgYW5kIHdoZW4gdGhleSBhcmUgbm90XG4vLyBzaG93IGVkaXQgc2xpZGVyIHdoZW4gZWRpdCBpcyBwcmVzc2VkXG4vLyBzaG93aW5nIHRhc2sgcHJpb3JpdHkgY29sb3VyIGFzIHRoZSBsZWZ0IGJvcmRlciBjb2xvdXIgb2YgdGhlIHRhc2tcbi8vIGNvbXBsZXRpbmcgdGFzayAtIGhvdyBkb2VzIGl0IGludGVyYWN0IHdpdGggZGF0YVxuLy8gc3RyaWtlIHRocm91Z2ggdGhlIHRpdGxlIHdoZW4gdGhlIHRhc2sgaXMgY29tcGxldGVcbi8vIGRlbGV0ZWluZyB0YXNrIC0gaG93IGRvZXMgaXQgaW50ZXJhY3Qgd2l0aCBkYXRhXG4vLyBwb3B1bGF0ZSB0aGUgdG9kYXkgYW5kIHRoaXMgd2VlayB2aWV3cyB3aXRoIHRoZSBjb3JyZWN0IHRhc2tzXG4vLyBwb3B1bGF0ZSBlYWNoIHByb2plY3Qgd2l0aCB0aGUgY29ycmVjdCB0YXNrc1xuLy9cbi8vXG4vL1xuXG5pbXBvcnQgeyBUb2RvVGFzayB9IGZyb20gXCIuL3Rhc2suanNcIjtcbmltcG9ydCB7IFByb2plY3QgfSBmcm9tIFwiLi9wcm9qZWN0LmpzXCI7XG5cbmNvbnN0IG1vZGVsID0ge1xuICB0YXNrczogW1xuICAgIFRvZG9UYXNrKFxuICAgICAgXCJIZWxsbyBXb3JsZFwiLFxuICAgICAgXCJvbmUgdHdvIHRocmVlXCIsXG4gICAgICBcIjIwMjItMDEtMjFcIixcbiAgICAgIGZhbHNlLFxuICAgICAgXCJoaWdoXCIsXG4gICAgICBcIkFsbFwiXG4gICAgKSxcbiAgICBUb2RvVGFzayhcbiAgICAgIFwiV29ybGQgSGVsbG9cIixcbiAgICAgIFwib25lIHR3byB0aHJlZVwiLFxuICAgICAgXCIyMDIyLTAyLTAxXCIsXG4gICAgICBmYWxzZSxcbiAgICAgIFwibG93XCIsXG4gICAgICBcIlByb2plY3QgMlwiXG4gICAgKSxcbiAgICBUb2RvVGFzayhcbiAgICAgIFwiT25lIE9uZSBPbmVcIixcbiAgICAgIFwib25lIHR3byB0aHJlZVwiLFxuICAgICAgXCIyMDIyLTA5LTE3XCIsXG4gICAgICBmYWxzZSxcbiAgICAgIFwibWlkZGxlXCIsXG4gICAgICBcIlByb2plY3QgMlwiXG4gICAgKSxcbiAgICBUb2RvVGFzayhcbiAgICAgIFwiVHdvIFR3byBUd29cIixcbiAgICAgIFwib25lIHR3byB0aHJlZVwiLFxuICAgICAgXCIyMDIyLTAxLTA5XCIsXG4gICAgICBmYWxzZSxcbiAgICAgIFwiaGlnaFwiLFxuICAgICAgXCJQcm9qZWN0IDNcIlxuICAgICksXG4gICAgVG9kb1Rhc2soXG4gICAgICBcIlRocmVlIFRocmVlIFRocmVlXCIsXG4gICAgICBcIm9uZSB0d28gdGhyZWVcIixcbiAgICAgIFwiMjAyMi0xMi0yNVwiLFxuICAgICAgZmFsc2UsXG4gICAgICBcImhpZ2hcIixcbiAgICAgIFwiQWxsXCJcbiAgICApLFxuICBdLFxuICBwcm9qZWN0czogW1Byb2plY3QoXCJBbGxcIiksIFByb2plY3QoXCJQcm9qZWN0IDJcIiksIFByb2plY3QoXCJQcm9qZWN0IDNcIildLFxufTtcblxuY29uc3QgbWVudUNvbnRyb2xsZXIgPSAoZnVuY3Rpb24gKCkge1xuICBjb25zdCBzaWRlYmFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zaWRlYmFyXCIpO1xuICBzaWRlYmFyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZlbnQpID0+IHtcbiAgICByZW1vdmVBY3RpdmUoKTtcbiAgICBldmVudC50YXJnZXQuY2xvc2VzdChcImFcIikuY2xhc3NMaXN0LmFkZChcImFjdGl2ZVwiKTtcbiAgfSk7XG59KSgpO1xuXG5mdW5jdGlvbiByZW1vdmVBY3RpdmUoKSB7XG4gIGxldCBidXR0b25zID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1lbnUtYnV0dG9uXCIpKTtcbiAgYnV0dG9ucy5mb3JFYWNoKChidXR0b24pID0+IGJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwiYWN0aXZlXCIpKTtcbn1cblxuY29uc3QgcHJvamVjdE1vZGFsID0gKGZ1bmN0aW9uICgpIHtcbiAgY29uc3QgbW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2plY3QtbW9kYWxcIik7XG4gIGNvbnN0IG9wZW5Nb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubmV3LXByb2plY3QtYnV0dG9uXCIpO1xuICBjb25zdCBjbG9zZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9qZWN0LW1vZGFsLWNsb3NlXCIpO1xuICBjb25zdCBzdWJtaXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2plY3Qtc3VibWl0XCIpO1xuICBjb25zdCBmb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJuZXctcHJvamVjdC1mb3JtXCIpO1xuXG4gIG9wZW5Nb2RhbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIHNob3dNb2RhbCgpO1xuICB9KTtcblxuICBjbG9zZU1vZGFsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgaGlkZU1vZGFsKCk7XG4gIH0pO1xuXG4gIHN1Ym1pdC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2ZW50KSA9PiB7XG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICBjb25zdCB0aXRsZSA9IGZvcm1bXCJ0aXRsZVwiXTtcbiAgICBjb25zdCB0aXRsZVZhbGlkID0gcHJvamVjdE1vZGFsVmFsaWRhdGlvbi5jaGVja1RpdGxlKHRpdGxlKTtcbiAgICBpZiAodGl0bGVWYWxpZCkge1xuICAgICAgLy8gY3JlYXRlIHByb2plY3RcbiAgICAgIGNvbnN0IG5ld1Byb2plY3QgPSBQcm9qZWN0KHRpdGxlLnZhbHVlKTtcbiAgICAgIC8vIHB1c2ggcHJvamVjdCB0byBzdG9yYWdlXG4gICAgICBtb2RlbC5wcm9qZWN0cy5wdXNoKG5ld1Byb2plY3QpO1xuICAgICAgLy8gcmVuZGVyIHByb2plY3RcbiAgICAgIHByb2plY3RNZW51Vmlldy5hZGRQcm9qZWN0VG9WaWV3KG5ld1Byb2plY3QpO1xuICAgICAgLy8gY2xlYXIgZm9ybVxuICAgICAgcHJvamVjdE1vZGFsVmFsaWRhdGlvbi5jbGVhckZvcm0oZm9ybSk7XG4gICAgICAvLyBjbG9zZSBtb2RhbFxuICAgICAgaGlkZU1vZGFsKCk7XG4gICAgfVxuICB9KTtcblxuICBjb25zdCBzaG93TW9kYWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgbW9kYWwuY2xhc3NMaXN0LnJlbW92ZShcImhpZGVcIik7XG4gICAgbW9kYWwuY2xhc3NMaXN0LmFkZChcInNob3dcIik7XG4gIH07XG5cbiAgY29uc3QgaGlkZU1vZGFsID0gZnVuY3Rpb24gKCkge1xuICAgIG1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoXCJzaG93XCIpO1xuICAgIG1vZGFsLmNsYXNzTGlzdC5hZGQoXCJoaWRlXCIpO1xuICB9O1xufSkoKTtcblxuY29uc3QgcHJvamVjdE1vZGFsVmFsaWRhdGlvbiA9IChmdW5jdGlvbiAoKSB7XG4gIGNvbnN0IGlzUmVxdWlyZWQgPSAodmFsdWUpID0+IHtcbiAgICByZXR1cm4gdmFsdWUgPT09IFwiXCI7XG4gIH07XG5cbiAgY29uc3Qgc2hvd0Vycm9yID0gKGlucHV0LCBtZXNzYWdlKSA9PiB7XG4gICAgaW5wdXQuY2xhc3NMaXN0LmFkZChcImVycm9yXCIpO1xuICB9O1xuXG4gIGNvbnN0IHNob3dTdWNjZXNzID0gKGlucHV0KSA9PiB7XG4gICAgaW5wdXQuY2xhc3NMaXN0LnJlbW92ZShcImVycm9yXCIpO1xuICB9O1xuXG4gIGNvbnN0IGNoZWNrVGl0bGUgPSAoZWxlbWVudCkgPT4ge1xuICAgIGxldCB2YWxpZCA9IGZhbHNlO1xuICAgIGNvbnN0IHRpdGxlID0gZWxlbWVudC52YWx1ZS50cmltKCk7XG4gICAgaWYgKGlzUmVxdWlyZWQodGl0bGUpKSB7XG4gICAgICBzaG93RXJyb3IoZWxlbWVudCwgXCJUaXRsZSBjYW5ub3QgYmUgZW1wdHkuXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzaG93U3VjY2VzcyhlbGVtZW50KTtcbiAgICAgIHZhbGlkID0gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIHZhbGlkO1xuICB9O1xuXG4gIGNvbnN0IGNsZWFyRm9ybSA9IChmb3JtKSA9PiB7XG4gICAgZm9ybVtcInRpdGxlXCJdLnZhbHVlID0gXCJcIjtcbiAgfTtcbiAgcmV0dXJuIHsgY2hlY2tUaXRsZSwgY2xlYXJGb3JtIH07XG59KSgpO1xuXG5jb25zdCBwcm9qZWN0TWVudVZpZXcgPSAoZnVuY3Rpb24gKCkge1xuICBjb25zdCBwcm9qZWN0TWVudSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvamVjdC1tZW51XCIpO1xuICBjb25zdCBmb3JtUHJvamVjdExpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmZvcm0tcHJvamVjdC1zZWxlY3RvclwiKTtcblxuICBjb25zdCBhZGRQcm9qZWN0VG9WaWV3ID0gKHByb2plY3QpID0+IHtcbiAgICBwcm9qZWN0TWVudS5hcHBlbmRDaGlsZChjcmVhdGVQcm9qZWN0Q29tcG9uZW50KHByb2plY3QpKTtcbiAgfTtcblxuICBjb25zdCBjcmVhdGVQcm9qZWN0Q29tcG9uZW50ID0gKHByb2plY3QpID0+IHtcbiAgICBjb25zdCBodG1sID0gYFxuICAgICAgPGEgaHJlZj1cIiNcIiBjbGFzcz1cIm5hdi1saW5rIG1lbnUtYnV0dG9uIGxpbmstZGFyayByb3VuZGVkXCI+XG4gICAgICAgIDxpbWdcbiAgICAgICAgICBjbGFzcz1cImJpIG1lLTJcIlxuICAgICAgICAgIHdpZHRoPVwiMTZcIlxuICAgICAgICAgIGhlaWdodD1cIjE2XCJcbiAgICAgICAgICBzcmM9XCIuLi9pY29ucy9hcnJvdy1yaWdodC1zaG9ydC5zdmdcIlxuICAgICAgICAvPjxzcGFuIGNsYXNzPVwiZC1ub25lIGQtc20taW5saW5lXCI+JHtwcm9qZWN0LnRpdGxlfTwvc3Bhbj48L2FcbiAgICAgID5gO1xuICAgIGNvbnN0IG5ld0VsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGlcIik7XG4gICAgbmV3RWxlbWVudC5jbGFzc0xpc3QgPSBcIm5hdi1pdGVtIG0tMVwiO1xuICAgIG5ld0VsZW1lbnQuaW5uZXJIVE1MID0gaHRtbDtcbiAgICByZXR1cm4gbmV3RWxlbWVudDtcbiAgfTtcblxuICBjb25zdCBhZGRQcm9qZWN0VG9Ub2RvU2VsZWN0b3JGb3JtID0gKCkgPT4ge1xuICAgIGxldCBodG1sID0gXCJcIjtcbiAgICBtb2RlbC5wcm9qZWN0cy5mb3JFYWNoKChwcm9qZWN0KSA9PiB7XG4gICAgICBodG1sICs9IGA8b3B0aW9uPiR7cHJvamVjdC50aXRsZX08L29wdGlvbj5gO1xuICAgIH0pO1xuICAgIGZvcm1Qcm9qZWN0TGlzdC5pbm5lckhUTUwgPSBodG1sO1xuICB9O1xuICByZXR1cm4geyBhZGRQcm9qZWN0VG9WaWV3LCBhZGRQcm9qZWN0VG9Ub2RvU2VsZWN0b3JGb3JtIH07XG59KSgpO1xuXG5jb25zdCB0b2RvTW9kYWwgPSAoZnVuY3Rpb24gKCkge1xuICBjb25zdCBtb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudGFzay1tb2RhbFwiKTtcbiAgY29uc3Qgb3Blbk1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50b2RvLW5ldy10YXNrXCIpO1xuICBjb25zdCBjbG9zZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50b2RvLW1vZGFsLWNsb3NlXCIpO1xuICBjb25zdCBmb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJuZXctdG9kby1mb3JtXCIpO1xuICBjb25zdCBzdWJtaXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRvZG8tc3VibWl0XCIpO1xuXG4gIG9wZW5Nb2RhbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIHByb2plY3RNZW51Vmlldy5hZGRQcm9qZWN0VG9Ub2RvU2VsZWN0b3JGb3JtKCk7XG4gICAgb3BlbigpO1xuICB9KTtcblxuICBjbG9zZU1vZGFsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgY2xvc2UoKTtcbiAgfSk7XG5cbiAgc3VibWl0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZlbnQpID0+IHtcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGNvbnN0IGZvcm1Qcm9qZWN0U2VsZWN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5mb3JtLXByb2plY3Qtc2VsZWN0b3JcIik7XG5cbiAgICAvLyBnZXQgZm9ybSBlbGVtZW50c1xuICAgIGNvbnN0IHRpdGxlID0gZm9ybVtcInRpdGxlXCJdO1xuICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gZm9ybVtcImRlc2NyaXB0aW9uXCJdO1xuICAgIGNvbnN0IGR1ZURhdGUgPSBmb3JtW1wiZHVlRGF0ZVwiXTtcbiAgICBjb25zdCBwcm9qZWN0ID1cbiAgICAgIGZvcm1Qcm9qZWN0U2VsZWN0Lm9wdGlvbnNbZm9ybVByb2plY3RTZWxlY3Quc2VsZWN0ZWRJbmRleF0udmFsdWU7XG4gICAgY29uc3QgcHJpb3JpdHkgPSBmb3JtW1wib3B0cmFkaW9cIl0udmFsdWU7XG5cbiAgICAvLyB2YWxpZGF0ZSBmb3JtIGVsZW1lbnRzXG4gICAgbGV0IHRpdGxlVmFsaWQgPSB0b2RvTW9kYWxWYWxpZGF0aW9uLmNoZWNrVGl0bGUodGl0bGUpLFxuICAgICAgZGVzY3JpcHRpb25WYWxpZCA9IHRvZG9Nb2RhbFZhbGlkYXRpb24uY2hlY2tEZXNjcmlwdGlvbihkZXNjcmlwdGlvbiksXG4gICAgICBkYXRlVmFsaWQgPSB0b2RvTW9kYWxWYWxpZGF0aW9uLmNoZWNrRGF0ZShkdWVEYXRlKTtcblxuICAgIGxldCBpc0Zvcm1WYWxpZCA9IHRpdGxlVmFsaWQgJiYgZGVzY3JpcHRpb25WYWxpZCAmJiBkYXRlVmFsaWQ7XG4gICAgLy8gY29uc3QgdGl0bGVWYWxpZCA9IHByb2plY3RNb2RhbFZhbGlkYXRpb24uY2hlY2tUaXRsZSh0aXRsZSk7XG4gICAgaWYgKGlzRm9ybVZhbGlkKSB7XG4gICAgICAvLyBjcmVhdGUgdG9kb1xuICAgICAgY29uc3QgbmV3VG9kbyA9IFRvZG9UYXNrKFxuICAgICAgICB0aXRsZS52YWx1ZSxcbiAgICAgICAgZGVzY3JpcHRpb24udmFsdWUsXG4gICAgICAgIGR1ZURhdGUudmFsdWUsXG4gICAgICAgIGZhbHNlLFxuICAgICAgICBwcmlvcml0eSxcbiAgICAgICAgcHJvamVjdFxuICAgICAgKTtcbiAgICAgIC8vIHB1c2ggdG9kbyB0byBzdG9yYWdlXG4gICAgICBtb2RlbC50YXNrcy5wdXNoKG5ld1RvZG8pO1xuICAgICAgLy8gcmVuZGVyIHRvZG9cbiAgICAgIHRvZG9WaWV3LmFkZFRvZG9Ub1ZpZXcobmV3VG9kbyk7XG4gICAgICAvLyBjbGVhciBmb3JtXG4gICAgICB0b2RvTW9kYWxWYWxpZGF0aW9uLmNsZWFyRm9ybShmb3JtKTtcbiAgICAgIC8vIGNsb3NlIG1vZGFsXG4gICAgICBjbG9zZSgpO1xuICAgIH1cbiAgfSk7XG5cbiAgY29uc3Qgb3BlbiA9ICgpID0+IHtcbiAgICBtb2RhbC5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZVwiKTtcbiAgICBtb2RhbC5jbGFzc0xpc3QuYWRkKFwic2hvd1wiKTtcbiAgfTtcblxuICBjb25zdCBjbG9zZSA9ICgpID0+IHtcbiAgICBtb2RhbC5jbGFzc0xpc3QucmVtb3ZlKFwic2hvd1wiKTtcbiAgICBtb2RhbC5jbGFzc0xpc3QuYWRkKFwiaGlkZVwiKTtcbiAgfTtcbn0pKCk7XG5cbmNvbnN0IHRvZG9Nb2RhbFZhbGlkYXRpb24gPSAoZnVuY3Rpb24gKCkge1xuICBjb25zdCBpc1JlcXVpcmVkID0gKHZhbHVlKSA9PiB7XG4gICAgcmV0dXJuIHZhbHVlID09PSBcIlwiO1xuICB9O1xuXG4gIGNvbnN0IG5vdEluRnV0dXJlID0gKHZhbHVlKSA9PiB7XG4gICAgY29uc3QgW3llYXIsIG1vbnRoLCBkYXldID0gdmFsdWUuc3BsaXQoXCItXCIpO1xuICAgIGNvbnN0IGN1cnJlbnREYXRlID0gbmV3IERhdGUoKTtcbiAgICBjb25zdCBjRGF5ID0gY3VycmVudERhdGUuZ2V0RGF0ZSgpO1xuICAgIGNvbnN0IGNNb250aCA9IGN1cnJlbnREYXRlLmdldE1vbnRoKCkgKyAxO1xuICAgIGNvbnN0IGNZZWFyID0gY3VycmVudERhdGUuZ2V0RnVsbFllYXIoKTtcbiAgICByZXR1cm4gISgreWVhciA+PSBjWWVhciAmJiArbW9udGggPj0gY01vbnRoICYmICtkYXkgPj0gY0RheSk7XG4gIH07XG5cbiAgY29uc3Qgc2hvd1RpdGxlRXJyb3IgPSAoaW5wdXQsIG1lc3NhZ2UpID0+IHtcbiAgICBjb25zdCBlcnJvciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudGl0bGVFcnJvclwiKTtcbiAgICBlcnJvci50ZXh0Q29udGVudCA9IG1lc3NhZ2U7XG4gIH07XG5cbiAgY29uc3Qgc2hvd0Rlc2NFcnJvciA9IChpbnB1dCwgbWVzc2FnZSkgPT4ge1xuICAgIGNvbnN0IGVycm9yID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5kZXNjRXJyb3JcIik7XG4gICAgZXJyb3IudGV4dENvbnRlbnQgPSBtZXNzYWdlO1xuICB9O1xuICBjb25zdCBzaG93RGF0ZUVycm9yID0gKGlucHV0LCBtZXNzYWdlKSA9PiB7XG4gICAgY29uc3QgZXJyb3IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmRhdGVFcnJvclwiKTtcbiAgICBlcnJvci50ZXh0Q29udGVudCA9IG1lc3NhZ2U7XG4gIH07XG5cbiAgY29uc3Qgc2hvd1RpdGxlU3VjY2VzcyA9IChpbnB1dCwgbWVzc2FnZSkgPT4ge1xuICAgIGNvbnN0IGVycm9yID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50aXRsZUVycm9yXCIpO1xuICAgIGVycm9yLnRleHRDb250ZW50ID0gXCJcIjtcbiAgfTtcblxuICBjb25zdCBzaG93RGVzY1N1Y2Nlc3MgPSAoaW5wdXQsIG1lc3NhZ2UpID0+IHtcbiAgICBjb25zdCBlcnJvciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZGVzY0Vycm9yXCIpO1xuICAgIGVycm9yLnRleHRDb250ZW50ID0gXCJcIjtcbiAgfTtcbiAgY29uc3Qgc2hvd0RhdGVTdWNjZXNzID0gKGlucHV0LCBtZXNzYWdlKSA9PiB7XG4gICAgY29uc3QgZXJyb3IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmRhdGVFcnJvclwiKTtcbiAgICBlcnJvci50ZXh0Q29udGVudCA9IFwiXCI7XG4gIH07XG5cbiAgY29uc3QgY2hlY2tUaXRsZSA9IChlbGVtZW50KSA9PiB7XG4gICAgbGV0IHZhbGlkID0gZmFsc2U7XG4gICAgY29uc3QgdGl0bGUgPSBlbGVtZW50LnZhbHVlLnRyaW0oKTtcbiAgICBpZiAoaXNSZXF1aXJlZCh0aXRsZSkpIHtcbiAgICAgIHNob3dUaXRsZUVycm9yKGVsZW1lbnQsIFwiVGl0bGUgY2Fubm90IGJlIGVtcHR5LlwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc2hvd1RpdGxlU3VjY2VzcyhlbGVtZW50KTtcbiAgICAgIHZhbGlkID0gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIHZhbGlkO1xuICB9O1xuXG4gIGNvbnN0IGNoZWNrRGVzY3JpcHRpb24gPSAoZWxlbWVudCkgPT4ge1xuICAgIGxldCB2YWxpZCA9IGZhbHNlO1xuICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gZWxlbWVudC52YWx1ZS50cmltKCk7XG4gICAgaWYgKGlzUmVxdWlyZWQoZGVzY3JpcHRpb24pKSB7XG4gICAgICBzaG93RGVzY0Vycm9yKGVsZW1lbnQsIFwiRGVzY3JpcHRpb24gY2Fubm90IGJlIGVtcHR5LlwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc2hvd0Rlc2NTdWNjZXNzKGVsZW1lbnQpO1xuICAgICAgdmFsaWQgPSB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gdmFsaWQ7XG4gIH07XG5cbiAgY29uc3QgY2hlY2tEYXRlID0gKGVsZW1lbnQpID0+IHtcbiAgICBsZXQgdmFsaWQgPSBmYWxzZTtcbiAgICBjb25zdCBkdWVEYXRlID0gZWxlbWVudC52YWx1ZS50cmltKCk7XG4gICAgaWYgKGlzUmVxdWlyZWQoZHVlRGF0ZSkpIHtcbiAgICAgIHNob3dEYXRlRXJyb3IoZWxlbWVudCwgXCJEdWUgZGF0ZSBjYW5ub3QgYmUgZW1wdHlcIik7XG4gICAgfVxuICAgIGlmIChub3RJbkZ1dHVyZShkdWVEYXRlKSkge1xuICAgICAgc2hvd0RhdGVFcnJvcihlbGVtZW50LCBcIkR1ZSBkYXRlIG11c3QgYmUgaW4gdGhlIGZ1dHVyZS5cIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNob3dEYXRlU3VjY2VzcyhlbGVtZW50KTtcbiAgICAgIHZhbGlkID0gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIHZhbGlkO1xuICB9O1xuXG4gIGNvbnN0IGNsZWFyRm9ybSA9IChmb3JtKSA9PiB7XG4gICAgZm9ybVtcInRpdGxlXCJdLnZhbHVlID0gXCJcIjtcbiAgICBmb3JtW1wiZGVzY3JpcHRpb25cIl0udmFsdWUgPSBcIlwiO1xuICAgIGZvcm1bXCJkdWVEYXRlXCJdLnZhbHVlID0gXCJcIjtcbiAgfTtcbiAgcmV0dXJuIHsgY2hlY2tUaXRsZSwgY2hlY2tEZXNjcmlwdGlvbiwgY2hlY2tEYXRlLCBjbGVhckZvcm0gfTtcbn0pKCk7XG5cbmNvbnN0IHRvZG9WaWV3ID0gKGZ1bmN0aW9uICgpIHtcbiAgY29uc3QgdG9kb0NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudG9kby1jb250YWluZXJcIik7XG5cbiAgY29uc3QgYWRkVG9kb1RvVmlldyA9ICh0b2RvKSA9PiB7XG4gICAgY29uc3QgZmlyc3RDaGlsZCA9IHRvZG9Db250YWluZXIuZmlyc3RFbGVtZW50Q2hpbGQ7XG4gICAgZmlyc3RDaGlsZC5pbnNlcnRBZGphY2VudEVsZW1lbnQoXCJiZWZvcmViZWdpblwiLCBjcmVhdGVUb2RvQ29tcG9uZW50KHRvZG8pKTtcbiAgfTtcblxuICBjb25zdCBjcmVhdGVUb2RvQ29tcG9uZW50ID0gKHRvZG8pID0+IHtcbiAgICBjb25zdCBodG1sID0gYFxuICAgIDxkaXZcbiAgICBjbGFzcz1cImNvbC1tZC0xIHB5LTEgZC1mbGV4IGp1c3RpZnktY29udGVudC1tZC1lbmQganVzdGlmeS1jb250ZW50LWNlbnRlclwiXG4gID5cbiAgICA8aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgLz5cbiAgPC9kaXY+XG4gIDxkaXZcbiAgICBjbGFzcz1cImNvbC1tZC02IGQtZmxleCBhbGlnbi1pdGVtcy1jZW50ZXIganVzdGlmeS1jb250ZW50LW1kLXN0YXJ0IGp1c3RpZnktY29udGVudC1jZW50ZXJcIlxuICA+XG4gICAgJHt0b2RvLnRpdGxlfVxuICA8L2Rpdj5cbiAgPGRpdlxuICAgIGNsYXNzPVwiY29sLW1kLTEgZC1mbGV4IGFsaWduLWl0ZW1zLWNlbnRlciBqdXN0aWZ5LW1kLXN0YXJ0IGp1c3RpZnktY29udGVudC1jZW50ZXJcIlxuICA+XG4gICAgPGEgaHJlZj1cIiNcIiBjbGFzcz1cIm5hdi1saW5rIGxpbmstZGFya1wiPlxuICAgICAgPGltZ1xuICAgICAgICBjbGFzcz1cIlwiXG4gICAgICAgIHdpZHRoPVwiMTZcIlxuICAgICAgICBoZWlnaHQ9XCIxNlwiXG4gICAgICAgIHNyYz1cIi4uL2ljb25zL2NhcmV0LWRvd24uc3ZnXCJcbiAgICAgIC8+XG4gICAgPC9hPlxuICA8L2Rpdj5cbiAgPGRpdlxuICAgIGNsYXNzPVwiY29sLW1kLTIgZC1mbGV4IGFsaWduLWl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNvbnRlbnQtbWQtc3RhcnQganVzdGlmeS1jb250ZW50LWNlbnRlclwiXG4gID5cbiAgICAke3RvZG8uZHVlRGF0ZX1cbiAgPC9kaXY+XG4gIDxkaXZcbiAgICBjbGFzcz1cImNvbC1tZC0xIGQtZmxleCBhbGlnbi1pdGVtcy1jZW50ZXIganVzdGlmeS1tZC1zdGFydCBqdXN0aWZ5LWNvbnRlbnQtY2VudGVyXCJcbiAgPlxuICAgIDxhIGhyZWY9XCIjXCIgY2xhc3M9XCJuYXYtbGluayBsaW5rLWRhcmtcIj5cbiAgICAgIDxpbWdcbiAgICAgICAgY2xhc3M9XCJcIlxuICAgICAgICB3aWR0aD1cIjE2XCJcbiAgICAgICAgaGVpZ2h0PVwiMTZcIlxuICAgICAgICBzcmM9XCIuLi9pY29ucy9wZW5jaWwtc3F1YXJlLnN2Z1wiXG4gICAgICAvPlxuICAgIDwvYT5cbiAgPC9kaXY+XG4gIDxkaXZcbiAgICBjbGFzcz1cImNvbC1tZC0xIGQtZmxleCBhbGlnbi1pdGVtcy1jZW50ZXIganVzdGlmeS1tZC1zdGFydCBqdXN0aWZ5LWNvbnRlbnQtY2VudGVyXCJcbiAgPlxuICAgIDxhIGhyZWY9XCIjXCIgY2xhc3M9XCJuYXYtbGluayBsaW5rLWRhcmtcIj5cbiAgICAgIDxpbWdcbiAgICAgICAgY2xhc3M9XCJcIlxuICAgICAgICB3aWR0aD1cIjE2XCJcbiAgICAgICAgaGVpZ2h0PVwiMTZcIlxuICAgICAgICBzcmM9XCIuLi9pY29ucy90cmFzaC5zdmdcIlxuICAgICAgLz5cbiAgICA8L2E+XG4gIDwvZGl2PmA7XG4gICAgY29uc3QgbmV3RWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgbmV3RWxlbWVudC5jbGFzc0xpc3QgPSBcInJvdyBtLTQgcC0yIGJnLXdoaXRlIHJvdW5kZWQtMyBib3JkZXItYm90dG9tXCI7XG4gICAgbmV3RWxlbWVudC5pbm5lckhUTUwgPSBodG1sO1xuICAgIHJldHVybiBuZXdFbGVtZW50O1xuICB9O1xuXG4gIHJldHVybiB7IGFkZFRvZG9Ub1ZpZXcgfTtcbn0pKCk7XG5cbm1vZGVsLnByb2plY3RzLmZvckVhY2goKHByb2plY3QpID0+IHByb2plY3RNZW51Vmlldy5hZGRQcm9qZWN0VG9WaWV3KHByb2plY3QpKTtcbm1vZGVsLnRhc2tzLmZvckVhY2goKHRhc2spID0+IHRvZG9WaWV3LmFkZFRvZG9Ub1ZpZXcodGFzaykpO1xuIl0sIm5hbWVzIjpbIlRvZG9UYXNrIiwidGl0bGUiLCJkZXNjcmlwdGlvbiIsImR1ZURhdGUiLCJjb21wbGV0ZWQiLCJwcmlvcml0eSIsInByb2plY3QiLCJ0YXNrIiwiZHVlIiwiUHJvamVjdCIsIm1vZGVsIiwidGFza3MiLCJwcm9qZWN0cyIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImFkZEV2ZW50TGlzdGVuZXIiLCJldmVudCIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiYnV0dG9uIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwidGFyZ2V0IiwiY2xvc2VzdCIsImFkZCIsIm1vZGFsIiwib3Blbk1vZGFsIiwiY2xvc2VNb2RhbCIsInN1Ym1pdCIsImZvcm0iLCJnZXRFbGVtZW50QnlJZCIsInNob3dNb2RhbCIsImhpZGVNb2RhbCIsInByZXZlbnREZWZhdWx0IiwicHJvamVjdE1vZGFsVmFsaWRhdGlvbiIsImNoZWNrVGl0bGUiLCJuZXdQcm9qZWN0IiwidmFsdWUiLCJwdXNoIiwicHJvamVjdE1lbnVWaWV3IiwiYWRkUHJvamVjdFRvVmlldyIsImNsZWFyRm9ybSIsImVsZW1lbnQiLCJ2YWxpZCIsInRyaW0iLCJwcm9qZWN0TWVudSIsImZvcm1Qcm9qZWN0TGlzdCIsImFwcGVuZENoaWxkIiwiaHRtbCIsIm5ld0VsZW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiaW5uZXJIVE1MIiwiY3JlYXRlUHJvamVjdENvbXBvbmVudCIsImFkZFByb2plY3RUb1RvZG9TZWxlY3RvckZvcm0iLCJ0b2RvTW9kYWxWYWxpZGF0aW9uIiwib3BlbiIsImNsb3NlIiwiZm9ybVByb2plY3RTZWxlY3QiLCJvcHRpb25zIiwic2VsZWN0ZWRJbmRleCIsInRpdGxlVmFsaWQiLCJkZXNjcmlwdGlvblZhbGlkIiwiY2hlY2tEZXNjcmlwdGlvbiIsImRhdGVWYWxpZCIsImNoZWNrRGF0ZSIsIm5ld1RvZG8iLCJ0b2RvVmlldyIsImFkZFRvZG9Ub1ZpZXciLCJpc1JlcXVpcmVkIiwic2hvd0RhdGVFcnJvciIsImlucHV0IiwibWVzc2FnZSIsInRleHRDb250ZW50IiwieWVhciIsIm1vbnRoIiwiZGF5Iiwic3BsaXQiLCJjdXJyZW50RGF0ZSIsIkRhdGUiLCJjRGF5IiwiZ2V0RGF0ZSIsImNNb250aCIsImdldE1vbnRoIiwiZ2V0RnVsbFllYXIiLCJub3RJbkZ1dHVyZSIsInRvZG9Db250YWluZXIiLCJ0b2RvIiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJpbnNlcnRBZGphY2VudEVsZW1lbnQiLCJjcmVhdGVUb2RvQ29tcG9uZW50Il0sInNvdXJjZVJvb3QiOiIifQ==