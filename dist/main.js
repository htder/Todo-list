(()=>{"use strict";const e=function(e,t,n,o,c,r){const s={};return s.title=e,s.description=t,s.dueDate=n,s.completed=o,s.priority=c,s.project=r,s.due=function(){return`${e} due: ${n}`},s},t=function(e){const t={};return t.title=e,t},n={tasks:[e("Hello World","one two three","2022-01-21",!0,"high","All"),e("World Hello","one two three","2022-02-01",!1,"low","Project 2"),e("One One One","one two three","2022-09-17",!0,"middle","Project 2"),e("Two Two Two","one two three","2022-01-09",!1,"high","Project 3"),e("Three Three Three","one two three","2022-12-25",!1,"high","All")],projects:[t("All"),t("Project 2"),t("Project 3")]};document.querySelector(".sidebar").addEventListener("click",(e=>{Array.from(document.querySelectorAll(".menu-button")).forEach((e=>e.classList.remove("active"))),null!==e.target.closest("a")&&e.target.closest("a").classList.add("active")})),function(){const e=document.querySelector(".project-modal"),r=document.querySelector(".new-project-button"),s=document.querySelector(".project-modal-close"),i=document.querySelector(".project-submit"),l=document.getElementById("new-project-form");r.addEventListener("click",(()=>{d()})),s.addEventListener("click",(()=>{a()})),i.addEventListener("click",(e=>{e.preventDefault();const r=l.title;if(o.checkTitle(r)){const e=t(r.value);n.projects.push(e),c.addProjectToView(e),o.clearForm(l),a()}}));const d=function(){e.classList.remove("hide"),e.classList.add("show")},a=function(){e.classList.remove("show"),e.classList.add("hide")}}();const o={checkTitle:e=>{let t=!1;return""===e.value.trim()?e.classList.add("error"):(e.classList.remove("error"),t=!0),t},clearForm:e=>{e.title.value=""}},c=function(){const e=document.querySelector(".project-menu"),t=document.querySelector(".form-project-selector");return{addProjectToView:t=>{e.appendChild((e=>{const t=`\n      <a href="#" class="nav-link menu-button link-dark rounded">\n        <img\n          class="bi me-2"\n          width="16"\n          height="16"\n          src="../icons/arrow-right-short.svg"\n        /><span class="d-none d-sm-inline">${e.title}</span></a\n      >`,n=document.createElement("li");return n.classList="nav-item m-1",n.innerHTML=t,n})(t))},addProjectToTodoSelectorForm:()=>{let e="";n.projects.forEach((t=>{e+=`<option>${t.title}</option>`})),t.innerHTML=e}}}(),r=(function(){const t=document.querySelector(".task-modal"),o=document.querySelector(".todo-new-task"),i=document.querySelector(".todo-modal-close"),l=document.getElementById("new-todo-form"),d=document.querySelector(".todo-submit");o.addEventListener("click",(()=>{c.addProjectToTodoSelectorForm(),a()})),i.addEventListener("click",(()=>{u()})),d.addEventListener("click",(t=>{t.preventDefault();const o=document.querySelector(".form-project-selector"),c=l.title,i=l.description,d=l.dueDate,a=o.options[o.selectedIndex].value,m=l.optradio.value;let h=r.checkTitle(c),v=r.checkDescription(i),f=r.checkDate(d);if(h&&v&&f){const t=e(c.value,i.value,d.value,!1,m,a);n.tasks.push(t),s.addTodoToView(t),r.clearForm(l),u()}}));const a=()=>{t.classList.remove("hide"),t.classList.add("show")},u=()=>{t.classList.remove("show"),t.classList.add("hide")}}(),function(){const e=e=>""===e,t=(e,t)=>{document.querySelector(".dateError").textContent=t};return{checkTitle:t=>{let n=!1;const o=t.value.trim();return e(o)?("Title cannot be empty.",document.querySelector(".titleError").textContent="Title cannot be empty."):(document.querySelector(".titleError").textContent="",n=!0),n},checkDescription:t=>{let n=!1;const o=t.value.trim();return e(o)?("Description cannot be empty.",document.querySelector(".descError").textContent="Description cannot be empty."):(document.querySelector(".descError").textContent="",n=!0),n},checkDate:n=>{let o=!1;const c=n.value.trim();return e(c)&&t(0,"Due date cannot be empty"),(e=>{const[t,n,o]=e.split("-"),c=new Date,r=c.getDate(),s=c.getMonth()+1;return!(+t>=c.getFullYear()&&+n>=s&&+o>=r)})(c)?t(0,"Due date must be in the future."):(document.querySelector(".dateError").textContent="",o=!0),o},clearForm:e=>{e.title.value="",e.description.value="",e.dueDate.value=""}}}()),s=function(){const e=document.querySelector(".todo-container");return{addTodoToView:t=>{e.firstElementChild.insertAdjacentElement("beforebegin",(e=>{const t=`\n    <div\n    class="col-md-1 py-1 d-flex justify-content-md-end justify-content-center"\n  >\n    <input type="checkbox" class="task-checkbox" ${e.completed?"checked":""}/>\n  </div>\n  <div\n    class="col-md-6 d-flex align-items-center justify-content-md-start justify-content-center"\n  >\n    ${e.title}\n  </div>\n  <div\n    class="col-md-1 d-flex align-items-center justify-md-start justify-content-center"\n  >\n    <a href="#" class="nav-link link-dark">\n      <img\n        class=""\n        width="16"\n        height="16"\n        src="../icons/caret-down.svg"\n      />\n    </a>\n  </div>\n  <div\n    class="col-md-2 d-flex align-items-center justify-content-md-start justify-content-center"\n  >\n    ${e.dueDate}\n  </div>\n  <div\n    class="col-md-1 d-flex align-items-center justify-md-start justify-content-center"\n  >\n    <a href="#" class="nav-link link-dark">\n      <img\n        class=""\n        width="16"\n        height="16"\n        src="../icons/pencil-square.svg"\n      />\n    </a>\n  </div>\n  <div\n    class="col-md-1 d-flex align-items-center justify-md-start justify-content-center"\n  >\n    <a href="#" class="nav-link link-dark">\n      <img\n        class=""\n        width="16"\n        height="16"\n        src="../icons/trash.svg"\n      />\n    </a>\n  </div>`,n=document.createElement("div");return n.classList="row m-4 p-2 bg-white rounded-3 border-bottom",n.innerHTML=t,n})(t))}}}();document.querySelector(".todo-container").addEventListener("click",(e=>{const t=e.target.classList.contains("task-checkbox");if(e.target.classList.contains("task-arrow"),e.target.classList.contains("task-edit"),e.target.classList.contains("task-delete"),t){const t=Array.from(e.target.parentNode.parentNode.childNodes),o=t[3].textContent.trim(),c=t[7].textContent.trim(),r=n.tasks.filter((e=>e.title===o&&e.dueDate===c));console.log(r),r[0].completed=!r[0].completed}console.log(n.tasks)})),n.projects.forEach((e=>c.addProjectToView(e))),n.tasks.forEach((e=>s.addTodoToView(e)))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Ly4vc3JjL3Rhc2suanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vc3JjL3Byb2plY3QuanMiLCJ3ZWJwYWNrOi8vdG9kby1saXN0Ly4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IFRvZG9UYXNrID0gZnVuY3Rpb24gKFxuICB0aXRsZSxcbiAgZGVzY3JpcHRpb24sXG4gIGR1ZURhdGUsXG4gIGNvbXBsZXRlZCxcbiAgcHJpb3JpdHksXG4gIHByb2plY3Rcbikge1xuICBjb25zdCB0YXNrID0ge307XG5cbiAgdGFzay50aXRsZSA9IHRpdGxlO1xuICB0YXNrLmRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb247XG4gIHRhc2suZHVlRGF0ZSA9IGR1ZURhdGU7XG4gIHRhc2suY29tcGxldGVkID0gY29tcGxldGVkO1xuICB0YXNrLnByaW9yaXR5ID0gcHJpb3JpdHk7XG4gIHRhc2sucHJvamVjdCA9IHByb2plY3Q7XG5cbiAgdGFzay5kdWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGAke3RpdGxlfSBkdWU6ICR7ZHVlRGF0ZX1gO1xuICB9O1xuXG4gIHJldHVybiB0YXNrO1xufTtcblxuZXhwb3J0IHsgVG9kb1Rhc2sgfTtcbiIsImNvbnN0IFByb2plY3QgPSBmdW5jdGlvbiAodGl0bGUpIHtcbiAgY29uc3QgcHJvamVjdCA9IHt9O1xuXG4gIHByb2plY3QudGl0bGUgPSB0aXRsZTtcblxuICByZXR1cm4gcHJvamVjdDtcbn07XG5cbmV4cG9ydCB7IFByb2plY3QgfTtcbiIsIi8vIFRvZG8gTGlzdCBJdGVtIG5lZWRzIGE6XG4vLyAtIHByb2plY3QgYmVsb25ncyB0b1xuLy8gLSB0aXRsZVxuLy8gLSBkZXNjcmlwdGlvblxuLy8gLSBkdWUgZGF0ZVxuLy8gLSBjb21wbGV0ZWQgY2hlY2sgYm94XG4vLyAtIHJlZCwgb3JhbmdlIG9yIGdyZWVuIGZvciBkaWZmZXJlbnQgcHJpb3JpdGllc1xuXG4vLyBGYWN0b3J5IGZ1bmN0aW9uIGZvciBhIHRvZG8gbGlzdCBpdGVtXG5cbi8vIFByb2plY3QgbmVlZHMgYTpcbi8vIC0gbGlzdCBvZiB6ZXJvIG9yIG1vcmUgdG9kbyBpdGVtc1xuXG4vLyBGYWN0b3J5IGZ1bmN0aW9uIGZvciBhIHByb2plY3RcblxuLy8gVmlld3M6XG4vLyAtIHNpZGViYXIgdmlld1xuLy8gLSBwcm9qZWN0IHZpZXdcbi8vIC0gYWxsIHRhc2sgdmlld1xuLy8gLSB0b2RheSdzIHRhc2tzIHZpZXdcbi8vIC0gdGhpcyB3ZWVrJ3MgdGFza3Mgdmlld1xuLy8gLSBwcm9qZWN0J3MgdGFza3Mgdmlld1xuXG4vLyBNb2RhbHM6XG4vLyAtIGVkaXQgdG9kbyBpdGVtXG4vLyAtIGNyZWF0ZSBuZXcgdG9kbyBpdGVtXG4vLyAtIGNyZWF0ZSBuZXcgcHJvamVjdFxuXG4vLyBUb2RvIENvbnRyb2xsZXI6XG4vLyAtIGRlbGV0ZSB0b2RvXG4vLyAtIHNob3cgZWRpdCBtb2RhbFxuLy8gLSBleHBhbmQgZGV0YWlsc1xuXG4vLyBQcm9qZWN0IENvbnRyb2xsZXI6XG4vLyAtIGRlbGV0ZSBwcm9qZWN0XG5cbi8vXG4vL1xuLy9cbi8vXG4vLyAvLyBjaGFuZ2luZyBhY3RpdmUgYnV0dG9uIG9uIHRoZSBtZW51XG4vLyAvLyBhZGRpbmcgcHJvamVjdCBtb2RhbCB3aGVuIG5ldyBwcm9qZWN0IGlzIHByZXNzZWRcbi8vIC8vIGFkZGluZyBuZXcgdG9kbyB0YXNrIG1vZGFsIHdoZW4gYWRkIGEgbmV3IHByb2plY3QgaXMgcHJlc3NlZFxuLy8gLy8gZGVjaWRlIG9uIGhvdyBkYXRhIGZvciB0YXNrcyBpcyBzdG9yZWRcbi8vIC8vIHN1Ym1pdHRpbmcgcHJvamVjdCBtb2RhbCBhZGRzIGEgbmV3IHByb2plY3QgLSBob3cgaXMgaXQgc3RvcmVkP1xuLy8gLy8gc3VibWl0dGluZyB0b2RvIHRhc2sgbW9kYWwgYWRkcyBhIG5ldyB0YXNrIC0gaG93IGlzIGl0IHN0b3JlZD9cbi8vIGFkZCBldmVudCBsaXN0ZW5lcnMgdG8gdGFza3Ncbi8vIHNob3cgZGV0YWlscyBzbGlkZXIgd2hlbiBkb3duIGFycm93IGlzIHByZXNzZWRcbi8vIGNoYW5nZSBhcnJvdyBpY29uIHdoZW4gZGV0YWlscyBhcmUgc2hvd2luZyBhbmQgd2hlbiB0aGV5IGFyZSBub3Rcbi8vIHNob3cgZWRpdCBzbGlkZXIgd2hlbiBlZGl0IGlzIHByZXNzZWRcbi8vIHNob3dpbmcgdGFzayBwcmlvcml0eSBjb2xvdXIgYXMgdGhlIGxlZnQgYm9yZGVyIGNvbG91ciBvZiB0aGUgdGFza1xuLy8gY29tcGxldGluZyB0YXNrIC0gaG93IGRvZXMgaXQgaW50ZXJhY3Qgd2l0aCBkYXRhXG4vLyBzdHJpa2UgdGhyb3VnaCB0aGUgdGl0bGUgd2hlbiB0aGUgdGFzayBpcyBjb21wbGV0ZVxuLy8gZGVsZXRlaW5nIHRhc2sgLSBob3cgZG9lcyBpdCBpbnRlcmFjdCB3aXRoIGRhdGFcbi8vIHBvcHVsYXRlIHRoZSB0b2RheSBhbmQgdGhpcyB3ZWVrIHZpZXdzIHdpdGggdGhlIGNvcnJlY3QgdGFza3Ncbi8vIHBvcHVsYXRlIGVhY2ggcHJvamVjdCB3aXRoIHRoZSBjb3JyZWN0IHRhc2tzXG4vL1xuLy9cbi8vXG5cbmltcG9ydCB7IFRvZG9UYXNrIH0gZnJvbSBcIi4vdGFzay5qc1wiO1xuaW1wb3J0IHsgUHJvamVjdCB9IGZyb20gXCIuL3Byb2plY3QuanNcIjtcblxuY29uc3QgbW9kZWwgPSB7XG4gIHRhc2tzOiBbXG4gICAgVG9kb1Rhc2soXCJIZWxsbyBXb3JsZFwiLCBcIm9uZSB0d28gdGhyZWVcIiwgXCIyMDIyLTAxLTIxXCIsIHRydWUsIFwiaGlnaFwiLCBcIkFsbFwiKSxcbiAgICBUb2RvVGFzayhcbiAgICAgIFwiV29ybGQgSGVsbG9cIixcbiAgICAgIFwib25lIHR3byB0aHJlZVwiLFxuICAgICAgXCIyMDIyLTAyLTAxXCIsXG4gICAgICBmYWxzZSxcbiAgICAgIFwibG93XCIsXG4gICAgICBcIlByb2plY3QgMlwiXG4gICAgKSxcbiAgICBUb2RvVGFzayhcbiAgICAgIFwiT25lIE9uZSBPbmVcIixcbiAgICAgIFwib25lIHR3byB0aHJlZVwiLFxuICAgICAgXCIyMDIyLTA5LTE3XCIsXG4gICAgICB0cnVlLFxuICAgICAgXCJtaWRkbGVcIixcbiAgICAgIFwiUHJvamVjdCAyXCJcbiAgICApLFxuICAgIFRvZG9UYXNrKFxuICAgICAgXCJUd28gVHdvIFR3b1wiLFxuICAgICAgXCJvbmUgdHdvIHRocmVlXCIsXG4gICAgICBcIjIwMjItMDEtMDlcIixcbiAgICAgIGZhbHNlLFxuICAgICAgXCJoaWdoXCIsXG4gICAgICBcIlByb2plY3QgM1wiXG4gICAgKSxcbiAgICBUb2RvVGFzayhcbiAgICAgIFwiVGhyZWUgVGhyZWUgVGhyZWVcIixcbiAgICAgIFwib25lIHR3byB0aHJlZVwiLFxuICAgICAgXCIyMDIyLTEyLTI1XCIsXG4gICAgICBmYWxzZSxcbiAgICAgIFwiaGlnaFwiLFxuICAgICAgXCJBbGxcIlxuICAgICksXG4gIF0sXG4gIHByb2plY3RzOiBbUHJvamVjdChcIkFsbFwiKSwgUHJvamVjdChcIlByb2plY3QgMlwiKSwgUHJvamVjdChcIlByb2plY3QgM1wiKV0sXG59O1xuXG5jb25zdCBtZW51Q29udHJvbGxlciA9IChmdW5jdGlvbiAoKSB7XG4gIGNvbnN0IHNpZGViYXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnNpZGViYXJcIik7XG4gIHNpZGViYXIuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldmVudCkgPT4ge1xuICAgIHJlbW92ZUFjdGl2ZSgpO1xuICAgIGlmIChldmVudC50YXJnZXQuY2xvc2VzdChcImFcIikgPT09IG51bGwpIHJldHVybjtcbiAgICBldmVudC50YXJnZXQuY2xvc2VzdChcImFcIikuY2xhc3NMaXN0LmFkZChcImFjdGl2ZVwiKTtcbiAgfSk7XG59KSgpO1xuXG5mdW5jdGlvbiByZW1vdmVBY3RpdmUoKSB7XG4gIGxldCBidXR0b25zID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1lbnUtYnV0dG9uXCIpKTtcbiAgYnV0dG9ucy5mb3JFYWNoKChidXR0b24pID0+IGJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwiYWN0aXZlXCIpKTtcbn1cblxuY29uc3QgcHJvamVjdE1vZGFsID0gKGZ1bmN0aW9uICgpIHtcbiAgY29uc3QgbW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2plY3QtbW9kYWxcIik7XG4gIGNvbnN0IG9wZW5Nb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubmV3LXByb2plY3QtYnV0dG9uXCIpO1xuICBjb25zdCBjbG9zZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9qZWN0LW1vZGFsLWNsb3NlXCIpO1xuICBjb25zdCBzdWJtaXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2plY3Qtc3VibWl0XCIpO1xuICBjb25zdCBmb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJuZXctcHJvamVjdC1mb3JtXCIpO1xuXG4gIG9wZW5Nb2RhbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIHNob3dNb2RhbCgpO1xuICB9KTtcblxuICBjbG9zZU1vZGFsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgaGlkZU1vZGFsKCk7XG4gIH0pO1xuXG4gIHN1Ym1pdC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2ZW50KSA9PiB7XG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICBjb25zdCB0aXRsZSA9IGZvcm1bXCJ0aXRsZVwiXTtcbiAgICBjb25zdCB0aXRsZVZhbGlkID0gcHJvamVjdE1vZGFsVmFsaWRhdGlvbi5jaGVja1RpdGxlKHRpdGxlKTtcbiAgICBpZiAodGl0bGVWYWxpZCkge1xuICAgICAgLy8gY3JlYXRlIHByb2plY3RcbiAgICAgIGNvbnN0IG5ld1Byb2plY3QgPSBQcm9qZWN0KHRpdGxlLnZhbHVlKTtcbiAgICAgIC8vIHB1c2ggcHJvamVjdCB0byBzdG9yYWdlXG4gICAgICBtb2RlbC5wcm9qZWN0cy5wdXNoKG5ld1Byb2plY3QpO1xuICAgICAgLy8gcmVuZGVyIHByb2plY3RcbiAgICAgIHByb2plY3RNZW51Vmlldy5hZGRQcm9qZWN0VG9WaWV3KG5ld1Byb2plY3QpO1xuICAgICAgLy8gY2xlYXIgZm9ybVxuICAgICAgcHJvamVjdE1vZGFsVmFsaWRhdGlvbi5jbGVhckZvcm0oZm9ybSk7XG4gICAgICAvLyBjbG9zZSBtb2RhbFxuICAgICAgaGlkZU1vZGFsKCk7XG4gICAgfVxuICB9KTtcblxuICBjb25zdCBzaG93TW9kYWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgbW9kYWwuY2xhc3NMaXN0LnJlbW92ZShcImhpZGVcIik7XG4gICAgbW9kYWwuY2xhc3NMaXN0LmFkZChcInNob3dcIik7XG4gIH07XG5cbiAgY29uc3QgaGlkZU1vZGFsID0gZnVuY3Rpb24gKCkge1xuICAgIG1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoXCJzaG93XCIpO1xuICAgIG1vZGFsLmNsYXNzTGlzdC5hZGQoXCJoaWRlXCIpO1xuICB9O1xufSkoKTtcblxuY29uc3QgcHJvamVjdE1vZGFsVmFsaWRhdGlvbiA9IChmdW5jdGlvbiAoKSB7XG4gIGNvbnN0IGlzUmVxdWlyZWQgPSAodmFsdWUpID0+IHtcbiAgICByZXR1cm4gdmFsdWUgPT09IFwiXCI7XG4gIH07XG5cbiAgY29uc3Qgc2hvd0Vycm9yID0gKGlucHV0LCBtZXNzYWdlKSA9PiB7XG4gICAgaW5wdXQuY2xhc3NMaXN0LmFkZChcImVycm9yXCIpO1xuICB9O1xuXG4gIGNvbnN0IHNob3dTdWNjZXNzID0gKGlucHV0KSA9PiB7XG4gICAgaW5wdXQuY2xhc3NMaXN0LnJlbW92ZShcImVycm9yXCIpO1xuICB9O1xuXG4gIGNvbnN0IGNoZWNrVGl0bGUgPSAoZWxlbWVudCkgPT4ge1xuICAgIGxldCB2YWxpZCA9IGZhbHNlO1xuICAgIGNvbnN0IHRpdGxlID0gZWxlbWVudC52YWx1ZS50cmltKCk7XG4gICAgaWYgKGlzUmVxdWlyZWQodGl0bGUpKSB7XG4gICAgICBzaG93RXJyb3IoZWxlbWVudCwgXCJUaXRsZSBjYW5ub3QgYmUgZW1wdHkuXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzaG93U3VjY2VzcyhlbGVtZW50KTtcbiAgICAgIHZhbGlkID0gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIHZhbGlkO1xuICB9O1xuXG4gIGNvbnN0IGNsZWFyRm9ybSA9IChmb3JtKSA9PiB7XG4gICAgZm9ybVtcInRpdGxlXCJdLnZhbHVlID0gXCJcIjtcbiAgfTtcbiAgcmV0dXJuIHsgY2hlY2tUaXRsZSwgY2xlYXJGb3JtIH07XG59KSgpO1xuXG5jb25zdCBwcm9qZWN0TWVudVZpZXcgPSAoZnVuY3Rpb24gKCkge1xuICBjb25zdCBwcm9qZWN0TWVudSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvamVjdC1tZW51XCIpO1xuICBjb25zdCBmb3JtUHJvamVjdExpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmZvcm0tcHJvamVjdC1zZWxlY3RvclwiKTtcblxuICBjb25zdCBhZGRQcm9qZWN0VG9WaWV3ID0gKHByb2plY3QpID0+IHtcbiAgICBwcm9qZWN0TWVudS5hcHBlbmRDaGlsZChjcmVhdGVQcm9qZWN0Q29tcG9uZW50KHByb2plY3QpKTtcbiAgfTtcblxuICBjb25zdCBjcmVhdGVQcm9qZWN0Q29tcG9uZW50ID0gKHByb2plY3QpID0+IHtcbiAgICBjb25zdCBodG1sID0gYFxuICAgICAgPGEgaHJlZj1cIiNcIiBjbGFzcz1cIm5hdi1saW5rIG1lbnUtYnV0dG9uIGxpbmstZGFyayByb3VuZGVkXCI+XG4gICAgICAgIDxpbWdcbiAgICAgICAgICBjbGFzcz1cImJpIG1lLTJcIlxuICAgICAgICAgIHdpZHRoPVwiMTZcIlxuICAgICAgICAgIGhlaWdodD1cIjE2XCJcbiAgICAgICAgICBzcmM9XCIuLi9pY29ucy9hcnJvdy1yaWdodC1zaG9ydC5zdmdcIlxuICAgICAgICAvPjxzcGFuIGNsYXNzPVwiZC1ub25lIGQtc20taW5saW5lXCI+JHtwcm9qZWN0LnRpdGxlfTwvc3Bhbj48L2FcbiAgICAgID5gO1xuICAgIGNvbnN0IG5ld0VsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGlcIik7XG4gICAgbmV3RWxlbWVudC5jbGFzc0xpc3QgPSBcIm5hdi1pdGVtIG0tMVwiO1xuICAgIG5ld0VsZW1lbnQuaW5uZXJIVE1MID0gaHRtbDtcbiAgICByZXR1cm4gbmV3RWxlbWVudDtcbiAgfTtcblxuICBjb25zdCBhZGRQcm9qZWN0VG9Ub2RvU2VsZWN0b3JGb3JtID0gKCkgPT4ge1xuICAgIGxldCBodG1sID0gXCJcIjtcbiAgICBtb2RlbC5wcm9qZWN0cy5mb3JFYWNoKChwcm9qZWN0KSA9PiB7XG4gICAgICBodG1sICs9IGA8b3B0aW9uPiR7cHJvamVjdC50aXRsZX08L29wdGlvbj5gO1xuICAgIH0pO1xuICAgIGZvcm1Qcm9qZWN0TGlzdC5pbm5lckhUTUwgPSBodG1sO1xuICB9O1xuICByZXR1cm4geyBhZGRQcm9qZWN0VG9WaWV3LCBhZGRQcm9qZWN0VG9Ub2RvU2VsZWN0b3JGb3JtIH07XG59KSgpO1xuXG5jb25zdCB0b2RvTW9kYWwgPSAoZnVuY3Rpb24gKCkge1xuICBjb25zdCBtb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudGFzay1tb2RhbFwiKTtcbiAgY29uc3Qgb3Blbk1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50b2RvLW5ldy10YXNrXCIpO1xuICBjb25zdCBjbG9zZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50b2RvLW1vZGFsLWNsb3NlXCIpO1xuICBjb25zdCBmb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJuZXctdG9kby1mb3JtXCIpO1xuICBjb25zdCBzdWJtaXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRvZG8tc3VibWl0XCIpO1xuXG4gIG9wZW5Nb2RhbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIHByb2plY3RNZW51Vmlldy5hZGRQcm9qZWN0VG9Ub2RvU2VsZWN0b3JGb3JtKCk7XG4gICAgb3BlbigpO1xuICB9KTtcblxuICBjbG9zZU1vZGFsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgY2xvc2UoKTtcbiAgfSk7XG5cbiAgc3VibWl0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZlbnQpID0+IHtcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGNvbnN0IGZvcm1Qcm9qZWN0U2VsZWN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5mb3JtLXByb2plY3Qtc2VsZWN0b3JcIik7XG5cbiAgICAvLyBnZXQgZm9ybSBlbGVtZW50c1xuICAgIGNvbnN0IHRpdGxlID0gZm9ybVtcInRpdGxlXCJdO1xuICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gZm9ybVtcImRlc2NyaXB0aW9uXCJdO1xuICAgIGNvbnN0IGR1ZURhdGUgPSBmb3JtW1wiZHVlRGF0ZVwiXTtcbiAgICBjb25zdCBwcm9qZWN0ID1cbiAgICAgIGZvcm1Qcm9qZWN0U2VsZWN0Lm9wdGlvbnNbZm9ybVByb2plY3RTZWxlY3Quc2VsZWN0ZWRJbmRleF0udmFsdWU7XG4gICAgY29uc3QgcHJpb3JpdHkgPSBmb3JtW1wib3B0cmFkaW9cIl0udmFsdWU7XG5cbiAgICAvLyB2YWxpZGF0ZSBmb3JtIGVsZW1lbnRzXG4gICAgbGV0IHRpdGxlVmFsaWQgPSB0b2RvTW9kYWxWYWxpZGF0aW9uLmNoZWNrVGl0bGUodGl0bGUpLFxuICAgICAgZGVzY3JpcHRpb25WYWxpZCA9IHRvZG9Nb2RhbFZhbGlkYXRpb24uY2hlY2tEZXNjcmlwdGlvbihkZXNjcmlwdGlvbiksXG4gICAgICBkYXRlVmFsaWQgPSB0b2RvTW9kYWxWYWxpZGF0aW9uLmNoZWNrRGF0ZShkdWVEYXRlKTtcblxuICAgIGxldCBpc0Zvcm1WYWxpZCA9IHRpdGxlVmFsaWQgJiYgZGVzY3JpcHRpb25WYWxpZCAmJiBkYXRlVmFsaWQ7XG4gICAgLy8gY29uc3QgdGl0bGVWYWxpZCA9IHByb2plY3RNb2RhbFZhbGlkYXRpb24uY2hlY2tUaXRsZSh0aXRsZSk7XG4gICAgaWYgKGlzRm9ybVZhbGlkKSB7XG4gICAgICAvLyBjcmVhdGUgdG9kb1xuICAgICAgY29uc3QgbmV3VG9kbyA9IFRvZG9UYXNrKFxuICAgICAgICB0aXRsZS52YWx1ZSxcbiAgICAgICAgZGVzY3JpcHRpb24udmFsdWUsXG4gICAgICAgIGR1ZURhdGUudmFsdWUsXG4gICAgICAgIGZhbHNlLFxuICAgICAgICBwcmlvcml0eSxcbiAgICAgICAgcHJvamVjdFxuICAgICAgKTtcbiAgICAgIC8vIHB1c2ggdG9kbyB0byBzdG9yYWdlXG4gICAgICBtb2RlbC50YXNrcy5wdXNoKG5ld1RvZG8pO1xuICAgICAgLy8gcmVuZGVyIHRvZG9cbiAgICAgIHRvZG9WaWV3LmFkZFRvZG9Ub1ZpZXcobmV3VG9kbyk7XG4gICAgICAvLyBjbGVhciBmb3JtXG4gICAgICB0b2RvTW9kYWxWYWxpZGF0aW9uLmNsZWFyRm9ybShmb3JtKTtcbiAgICAgIC8vIGNsb3NlIG1vZGFsXG4gICAgICBjbG9zZSgpO1xuICAgIH1cbiAgfSk7XG5cbiAgY29uc3Qgb3BlbiA9ICgpID0+IHtcbiAgICBtb2RhbC5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZVwiKTtcbiAgICBtb2RhbC5jbGFzc0xpc3QuYWRkKFwic2hvd1wiKTtcbiAgfTtcblxuICBjb25zdCBjbG9zZSA9ICgpID0+IHtcbiAgICBtb2RhbC5jbGFzc0xpc3QucmVtb3ZlKFwic2hvd1wiKTtcbiAgICBtb2RhbC5jbGFzc0xpc3QuYWRkKFwiaGlkZVwiKTtcbiAgfTtcbn0pKCk7XG5cbmNvbnN0IHRvZG9Nb2RhbFZhbGlkYXRpb24gPSAoZnVuY3Rpb24gKCkge1xuICBjb25zdCBpc1JlcXVpcmVkID0gKHZhbHVlKSA9PiB7XG4gICAgcmV0dXJuIHZhbHVlID09PSBcIlwiO1xuICB9O1xuXG4gIGNvbnN0IG5vdEluRnV0dXJlID0gKHZhbHVlKSA9PiB7XG4gICAgY29uc3QgW3llYXIsIG1vbnRoLCBkYXldID0gdmFsdWUuc3BsaXQoXCItXCIpO1xuICAgIGNvbnN0IGN1cnJlbnREYXRlID0gbmV3IERhdGUoKTtcbiAgICBjb25zdCBjRGF5ID0gY3VycmVudERhdGUuZ2V0RGF0ZSgpO1xuICAgIGNvbnN0IGNNb250aCA9IGN1cnJlbnREYXRlLmdldE1vbnRoKCkgKyAxO1xuICAgIGNvbnN0IGNZZWFyID0gY3VycmVudERhdGUuZ2V0RnVsbFllYXIoKTtcbiAgICByZXR1cm4gISgreWVhciA+PSBjWWVhciAmJiArbW9udGggPj0gY01vbnRoICYmICtkYXkgPj0gY0RheSk7XG4gIH07XG5cbiAgY29uc3Qgc2hvd1RpdGxlRXJyb3IgPSAoaW5wdXQsIG1lc3NhZ2UpID0+IHtcbiAgICBjb25zdCBlcnJvciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudGl0bGVFcnJvclwiKTtcbiAgICBlcnJvci50ZXh0Q29udGVudCA9IG1lc3NhZ2U7XG4gIH07XG5cbiAgY29uc3Qgc2hvd0Rlc2NFcnJvciA9IChpbnB1dCwgbWVzc2FnZSkgPT4ge1xuICAgIGNvbnN0IGVycm9yID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5kZXNjRXJyb3JcIik7XG4gICAgZXJyb3IudGV4dENvbnRlbnQgPSBtZXNzYWdlO1xuICB9O1xuICBjb25zdCBzaG93RGF0ZUVycm9yID0gKGlucHV0LCBtZXNzYWdlKSA9PiB7XG4gICAgY29uc3QgZXJyb3IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmRhdGVFcnJvclwiKTtcbiAgICBlcnJvci50ZXh0Q29udGVudCA9IG1lc3NhZ2U7XG4gIH07XG5cbiAgY29uc3Qgc2hvd1RpdGxlU3VjY2VzcyA9IChpbnB1dCwgbWVzc2FnZSkgPT4ge1xuICAgIGNvbnN0IGVycm9yID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50aXRsZUVycm9yXCIpO1xuICAgIGVycm9yLnRleHRDb250ZW50ID0gXCJcIjtcbiAgfTtcblxuICBjb25zdCBzaG93RGVzY1N1Y2Nlc3MgPSAoaW5wdXQsIG1lc3NhZ2UpID0+IHtcbiAgICBjb25zdCBlcnJvciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZGVzY0Vycm9yXCIpO1xuICAgIGVycm9yLnRleHRDb250ZW50ID0gXCJcIjtcbiAgfTtcbiAgY29uc3Qgc2hvd0RhdGVTdWNjZXNzID0gKGlucHV0LCBtZXNzYWdlKSA9PiB7XG4gICAgY29uc3QgZXJyb3IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmRhdGVFcnJvclwiKTtcbiAgICBlcnJvci50ZXh0Q29udGVudCA9IFwiXCI7XG4gIH07XG5cbiAgY29uc3QgY2hlY2tUaXRsZSA9IChlbGVtZW50KSA9PiB7XG4gICAgbGV0IHZhbGlkID0gZmFsc2U7XG4gICAgY29uc3QgdGl0bGUgPSBlbGVtZW50LnZhbHVlLnRyaW0oKTtcbiAgICBpZiAoaXNSZXF1aXJlZCh0aXRsZSkpIHtcbiAgICAgIHNob3dUaXRsZUVycm9yKGVsZW1lbnQsIFwiVGl0bGUgY2Fubm90IGJlIGVtcHR5LlwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc2hvd1RpdGxlU3VjY2VzcyhlbGVtZW50KTtcbiAgICAgIHZhbGlkID0gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIHZhbGlkO1xuICB9O1xuXG4gIGNvbnN0IGNoZWNrRGVzY3JpcHRpb24gPSAoZWxlbWVudCkgPT4ge1xuICAgIGxldCB2YWxpZCA9IGZhbHNlO1xuICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gZWxlbWVudC52YWx1ZS50cmltKCk7XG4gICAgaWYgKGlzUmVxdWlyZWQoZGVzY3JpcHRpb24pKSB7XG4gICAgICBzaG93RGVzY0Vycm9yKGVsZW1lbnQsIFwiRGVzY3JpcHRpb24gY2Fubm90IGJlIGVtcHR5LlwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc2hvd0Rlc2NTdWNjZXNzKGVsZW1lbnQpO1xuICAgICAgdmFsaWQgPSB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gdmFsaWQ7XG4gIH07XG5cbiAgY29uc3QgY2hlY2tEYXRlID0gKGVsZW1lbnQpID0+IHtcbiAgICBsZXQgdmFsaWQgPSBmYWxzZTtcbiAgICBjb25zdCBkdWVEYXRlID0gZWxlbWVudC52YWx1ZS50cmltKCk7XG4gICAgaWYgKGlzUmVxdWlyZWQoZHVlRGF0ZSkpIHtcbiAgICAgIHNob3dEYXRlRXJyb3IoZWxlbWVudCwgXCJEdWUgZGF0ZSBjYW5ub3QgYmUgZW1wdHlcIik7XG4gICAgfVxuICAgIGlmIChub3RJbkZ1dHVyZShkdWVEYXRlKSkge1xuICAgICAgc2hvd0RhdGVFcnJvcihlbGVtZW50LCBcIkR1ZSBkYXRlIG11c3QgYmUgaW4gdGhlIGZ1dHVyZS5cIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNob3dEYXRlU3VjY2VzcyhlbGVtZW50KTtcbiAgICAgIHZhbGlkID0gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIHZhbGlkO1xuICB9O1xuXG4gIGNvbnN0IGNsZWFyRm9ybSA9IChmb3JtKSA9PiB7XG4gICAgZm9ybVtcInRpdGxlXCJdLnZhbHVlID0gXCJcIjtcbiAgICBmb3JtW1wiZGVzY3JpcHRpb25cIl0udmFsdWUgPSBcIlwiO1xuICAgIGZvcm1bXCJkdWVEYXRlXCJdLnZhbHVlID0gXCJcIjtcbiAgfTtcbiAgcmV0dXJuIHsgY2hlY2tUaXRsZSwgY2hlY2tEZXNjcmlwdGlvbiwgY2hlY2tEYXRlLCBjbGVhckZvcm0gfTtcbn0pKCk7XG5cbmNvbnN0IHRvZG9WaWV3ID0gKGZ1bmN0aW9uICgpIHtcbiAgY29uc3QgdG9kb0NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudG9kby1jb250YWluZXJcIik7XG5cbiAgY29uc3QgYWRkVG9kb1RvVmlldyA9ICh0b2RvKSA9PiB7XG4gICAgY29uc3QgZmlyc3RDaGlsZCA9IHRvZG9Db250YWluZXIuZmlyc3RFbGVtZW50Q2hpbGQ7XG4gICAgZmlyc3RDaGlsZC5pbnNlcnRBZGphY2VudEVsZW1lbnQoXCJiZWZvcmViZWdpblwiLCBjcmVhdGVUb2RvQ29tcG9uZW50KHRvZG8pKTtcbiAgfTtcblxuICBjb25zdCBjcmVhdGVUb2RvQ29tcG9uZW50ID0gKHRvZG8pID0+IHtcbiAgICBjb25zdCBodG1sID0gYFxuICAgIDxkaXZcbiAgICBjbGFzcz1cImNvbC1tZC0xIHB5LTEgZC1mbGV4IGp1c3RpZnktY29udGVudC1tZC1lbmQganVzdGlmeS1jb250ZW50LWNlbnRlclwiXG4gID5cbiAgICA8aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgY2xhc3M9XCJ0YXNrLWNoZWNrYm94XCIgJHtcbiAgICAgIHRvZG8uY29tcGxldGVkID8gXCJjaGVja2VkXCIgOiBcIlwiXG4gICAgfS8+XG4gIDwvZGl2PlxuICA8ZGl2XG4gICAgY2xhc3M9XCJjb2wtbWQtNiBkLWZsZXggYWxpZ24taXRlbXMtY2VudGVyIGp1c3RpZnktY29udGVudC1tZC1zdGFydCBqdXN0aWZ5LWNvbnRlbnQtY2VudGVyXCJcbiAgPlxuICAgICR7dG9kby50aXRsZX1cbiAgPC9kaXY+XG4gIDxkaXZcbiAgICBjbGFzcz1cImNvbC1tZC0xIGQtZmxleCBhbGlnbi1pdGVtcy1jZW50ZXIganVzdGlmeS1tZC1zdGFydCBqdXN0aWZ5LWNvbnRlbnQtY2VudGVyXCJcbiAgPlxuICAgIDxhIGhyZWY9XCIjXCIgY2xhc3M9XCJuYXYtbGluayBsaW5rLWRhcmtcIj5cbiAgICAgIDxpbWdcbiAgICAgICAgY2xhc3M9XCJcIlxuICAgICAgICB3aWR0aD1cIjE2XCJcbiAgICAgICAgaGVpZ2h0PVwiMTZcIlxuICAgICAgICBzcmM9XCIuLi9pY29ucy9jYXJldC1kb3duLnN2Z1wiXG4gICAgICAvPlxuICAgIDwvYT5cbiAgPC9kaXY+XG4gIDxkaXZcbiAgICBjbGFzcz1cImNvbC1tZC0yIGQtZmxleCBhbGlnbi1pdGVtcy1jZW50ZXIganVzdGlmeS1jb250ZW50LW1kLXN0YXJ0IGp1c3RpZnktY29udGVudC1jZW50ZXJcIlxuICA+XG4gICAgJHt0b2RvLmR1ZURhdGV9XG4gIDwvZGl2PlxuICA8ZGl2XG4gICAgY2xhc3M9XCJjb2wtbWQtMSBkLWZsZXggYWxpZ24taXRlbXMtY2VudGVyIGp1c3RpZnktbWQtc3RhcnQganVzdGlmeS1jb250ZW50LWNlbnRlclwiXG4gID5cbiAgICA8YSBocmVmPVwiI1wiIGNsYXNzPVwibmF2LWxpbmsgbGluay1kYXJrXCI+XG4gICAgICA8aW1nXG4gICAgICAgIGNsYXNzPVwiXCJcbiAgICAgICAgd2lkdGg9XCIxNlwiXG4gICAgICAgIGhlaWdodD1cIjE2XCJcbiAgICAgICAgc3JjPVwiLi4vaWNvbnMvcGVuY2lsLXNxdWFyZS5zdmdcIlxuICAgICAgLz5cbiAgICA8L2E+XG4gIDwvZGl2PlxuICA8ZGl2XG4gICAgY2xhc3M9XCJjb2wtbWQtMSBkLWZsZXggYWxpZ24taXRlbXMtY2VudGVyIGp1c3RpZnktbWQtc3RhcnQganVzdGlmeS1jb250ZW50LWNlbnRlclwiXG4gID5cbiAgICA8YSBocmVmPVwiI1wiIGNsYXNzPVwibmF2LWxpbmsgbGluay1kYXJrXCI+XG4gICAgICA8aW1nXG4gICAgICAgIGNsYXNzPVwiXCJcbiAgICAgICAgd2lkdGg9XCIxNlwiXG4gICAgICAgIGhlaWdodD1cIjE2XCJcbiAgICAgICAgc3JjPVwiLi4vaWNvbnMvdHJhc2guc3ZnXCJcbiAgICAgIC8+XG4gICAgPC9hPlxuICA8L2Rpdj5gO1xuICAgIGNvbnN0IG5ld0VsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIG5ld0VsZW1lbnQuY2xhc3NMaXN0ID0gXCJyb3cgbS00IHAtMiBiZy13aGl0ZSByb3VuZGVkLTMgYm9yZGVyLWJvdHRvbVwiO1xuICAgIG5ld0VsZW1lbnQuaW5uZXJIVE1MID0gaHRtbDtcbiAgICByZXR1cm4gbmV3RWxlbWVudDtcbiAgfTtcblxuICByZXR1cm4geyBhZGRUb2RvVG9WaWV3IH07XG59KSgpO1xuXG5jb25zdCB0YXNrc0xpc3RlbmVyID0gKGZ1bmN0aW9uICgpIHtcbiAgY29uc3QgdG9kb0NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudG9kby1jb250YWluZXJcIik7XG4gIHRvZG9Db250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldmVudCkgPT4ge1xuICAgIGNvbnN0IGNoZWNrYm94Q29udGFpbmVyID0gZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcInRhc2stY2hlY2tib3hcIik7XG4gICAgY29uc3QgYXJyb3dDb250YWluZXIgPSBldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwidGFzay1hcnJvd1wiKTtcbiAgICBjb25zdCBlZGl0Q29udGFpbmVyID0gZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcInRhc2stZWRpdFwiKTtcbiAgICBjb25zdCBkZWxldGVDb250YWluZXIgPSBldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwidGFzay1kZWxldGVcIik7XG5cbiAgICBpZiAoY2hlY2tib3hDb250YWluZXIpIHtcbiAgICAgIGNvbnN0IHJvdyA9IEFycmF5LmZyb20oZXZlbnQudGFyZ2V0LnBhcmVudE5vZGUucGFyZW50Tm9kZS5jaGlsZE5vZGVzKTtcbiAgICAgIGNvbnN0IHRpdGxlID0gcm93WzNdLnRleHRDb250ZW50LnRyaW0oKTtcbiAgICAgIGNvbnN0IGRhdGUgPSByb3dbN10udGV4dENvbnRlbnQudHJpbSgpO1xuXG4gICAgICBjb25zdCB0YXNrID0gbW9kZWwudGFza3MuZmlsdGVyKFxuICAgICAgICAodGFzaykgPT4gdGFzay50aXRsZSA9PT0gdGl0bGUgJiYgdGFzay5kdWVEYXRlID09PSBkYXRlXG4gICAgICApO1xuICAgICAgY29uc29sZS5sb2codGFzayk7XG4gICAgICB0YXNrWzBdLmNvbXBsZXRlZCA9ICF0YXNrWzBdLmNvbXBsZXRlZDtcbiAgICB9XG4gICAgY29uc29sZS5sb2cobW9kZWwudGFza3MpO1xuICB9KTtcbiAgcmV0dXJuIHt9O1xufSkoKTtcblxubW9kZWwucHJvamVjdHMuZm9yRWFjaCgocHJvamVjdCkgPT4gcHJvamVjdE1lbnVWaWV3LmFkZFByb2plY3RUb1ZpZXcocHJvamVjdCkpO1xubW9kZWwudGFza3MuZm9yRWFjaCgodGFzaykgPT4gdG9kb1ZpZXcuYWRkVG9kb1RvVmlldyh0YXNrKSk7XG4iXSwibmFtZXMiOlsiVG9kb1Rhc2siLCJ0aXRsZSIsImRlc2NyaXB0aW9uIiwiZHVlRGF0ZSIsImNvbXBsZXRlZCIsInByaW9yaXR5IiwicHJvamVjdCIsInRhc2siLCJkdWUiLCJQcm9qZWN0IiwibW9kZWwiLCJ0YXNrcyIsInByb2plY3RzIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2ZW50IiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJidXR0b24iLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJ0YXJnZXQiLCJjbG9zZXN0IiwiYWRkIiwibW9kYWwiLCJvcGVuTW9kYWwiLCJjbG9zZU1vZGFsIiwic3VibWl0IiwiZm9ybSIsImdldEVsZW1lbnRCeUlkIiwic2hvd01vZGFsIiwiaGlkZU1vZGFsIiwicHJldmVudERlZmF1bHQiLCJwcm9qZWN0TW9kYWxWYWxpZGF0aW9uIiwiY2hlY2tUaXRsZSIsIm5ld1Byb2plY3QiLCJ2YWx1ZSIsInB1c2giLCJwcm9qZWN0TWVudVZpZXciLCJhZGRQcm9qZWN0VG9WaWV3IiwiY2xlYXJGb3JtIiwiZWxlbWVudCIsInZhbGlkIiwidHJpbSIsInByb2plY3RNZW51IiwiZm9ybVByb2plY3RMaXN0IiwiYXBwZW5kQ2hpbGQiLCJodG1sIiwibmV3RWxlbWVudCIsImNyZWF0ZUVsZW1lbnQiLCJpbm5lckhUTUwiLCJjcmVhdGVQcm9qZWN0Q29tcG9uZW50IiwiYWRkUHJvamVjdFRvVG9kb1NlbGVjdG9yRm9ybSIsInRvZG9Nb2RhbFZhbGlkYXRpb24iLCJvcGVuIiwiY2xvc2UiLCJmb3JtUHJvamVjdFNlbGVjdCIsIm9wdGlvbnMiLCJzZWxlY3RlZEluZGV4IiwidGl0bGVWYWxpZCIsImRlc2NyaXB0aW9uVmFsaWQiLCJjaGVja0Rlc2NyaXB0aW9uIiwiZGF0ZVZhbGlkIiwiY2hlY2tEYXRlIiwibmV3VG9kbyIsInRvZG9WaWV3IiwiYWRkVG9kb1RvVmlldyIsImlzUmVxdWlyZWQiLCJzaG93RGF0ZUVycm9yIiwiaW5wdXQiLCJtZXNzYWdlIiwidGV4dENvbnRlbnQiLCJ5ZWFyIiwibW9udGgiLCJkYXkiLCJzcGxpdCIsImN1cnJlbnREYXRlIiwiRGF0ZSIsImNEYXkiLCJnZXREYXRlIiwiY01vbnRoIiwiZ2V0TW9udGgiLCJnZXRGdWxsWWVhciIsIm5vdEluRnV0dXJlIiwidG9kb0NvbnRhaW5lciIsInRvZG8iLCJmaXJzdEVsZW1lbnRDaGlsZCIsImluc2VydEFkamFjZW50RWxlbWVudCIsImNyZWF0ZVRvZG9Db21wb25lbnQiLCJjaGVja2JveENvbnRhaW5lciIsImNvbnRhaW5zIiwicm93IiwicGFyZW50Tm9kZSIsImNoaWxkTm9kZXMiLCJkYXRlIiwiZmlsdGVyIiwiY29uc29sZSIsImxvZyJdLCJzb3VyY2VSb290IjoiIn0=